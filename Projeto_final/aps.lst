MPASM  5.51                           APS.ASM   7-1-2016  15:53:01         PAGE  1


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00001 ;----------------------------------------------------------------------------
                      00002 ;                                                       ENGENHARIA ELETRONICA                           
                                                    |
                      00003 ; Disciplina: Microcontroladores                                                                        
                                            |
                      00004 ; ATIVIDADE PRÁTICA SUPERVISIONADA                                                                     
                                            |
                      00005 ; Projeto: 2 - Sensor de temperatura                                                                    
                                    |
                      00006 ; Alunos: Rodrigo Antonio Sbardeloto Kraemer                                                            
                            |
                      00007 ;                 Mateus Milani                                                                         
                                                            |
                      00008 ;Data:  30/06/2016                                                                                      
                                                            |
                      00009 ;                                                                                                       
                                                                            |
                      00010 ;----------------------------------------------------------------------------
                      00011 ;                             DESCRICAO GERAL                             
                      00012 
                      00013 ;Le o sensor de temperatura, escreve a temperatura no display e envia para o 
                      00014 ;terminal, no PC. Salva a temperatura na memoria E2PROM (cada 30 s). Via 
                      00015 ;teclado do PC consegue ler os valores salvos. Atraves da lampada controla-se 
                      00016 ;a temperatura.
                      00017 
                      00018 ;----------------------------------------------------------------------------
                      00019 ;                       CONFIGURACAO DOS JUMPERS DE PLACA                  
                      00020 
                      00021 ; Habilitar o dip CH1,2 e 3.
                      00022 ; Habilitar todos os dips CH4 (ON).
                      00023 ; Habilitar o dip CH3,1.
                      00024 ; Habilitar o dip CH6,1-2.
                      00025 ; Habilitar o dip CH5,1-4.
                      00026 ; Desabilitar as demais chaves DIP.
                      00027 ; Manter o jumper J3 na posicao A e J4 na posição B.
                      00028 ;----------------------------------------------------------------------------
                      00029 ;                          CONFIGURACOES PARA GRAVACAO                     
                      00030 
2007   3739           00031  __CONFIG _WDT_OFF & _XT_OSC & _LVP_OFF & _DEBUG_ON & _BODEN_OFF
                      00032 
                      00033 ;_CP_OFF        ==> MEMORIA DE PROGRAMA DESPROTEGIDA CONTRA LEITURA.
                      00034 ;_WRT_OFF       ==> SEM PERMISSÃO PARA ESCREVER NA MEMORIA DE PROGRAMA
                      00035 ;                               DURANTE EXECUCAO DO PROGRAMA.
                      00036 ;_DEBUG_ON      ==> DEBUG ATIVADO.
                      00037 ;_CPD_OFF       ==> MEMÓRIA EEPROM PROTEGIDA CONTRA LEITURA.
                      00038 ;_LVP_OFF       ==> PROGRAMACAO EM BAIXA TENSÃO DESABILITADA.
                      00039 ;_WDT_OFF       ==> WDT DESATIVADO.
                      00040 ;_BODEN_OFF     ==> BROWN-OUT DESATIVADO. 
                      00041 ;_PWRTE_ON      ==> POWER-ON RESET ATIVADO.
                      00042 ;_XT_OSC        ==> OSCILADOR CRISTAL (4MHz).
                      00043 
                      00044 ;----------------------------------------------------------------------------
                      00045 ;                           ARQUIVOS DE DEFINICOES                         
MPASM  5.51                           APS.ASM   7-1-2016  15:53:01         PAGE  2


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00046 
                      00047 #INCLUDE        <P16F877.INC>           ;Arquivo padrão microchip para 16F877
                      00001         LIST
                      00002 
                      00003 ;==========================================================================
                      00004 ;  MPASM PIC16F877 processor include
                      00005 ; 
                      00006 ;  (c) Copyright 1999-2013 Microchip Technology, All rights reserved
                      00007 ;==========================================================================
                      00008 
                      00540         LIST
                      00048 
                      00049 ;----------------------------------------------------------------------------
                      00050 ;                          DEFINICOES DAS CONSTANTES                        
                      00051 
                      00052 
                      00053 ;----------------------------------------------------------------------------
                      00054 ;                                                       MACROS                                          
                                
                      00055 
                      00056 ;----------------------------------------------------------------------------
                      00057 ;                            DEFINICAO DAS VARIAVEIS                      
                      00058 
                      00059         CBLOCK  0x20                    ;Posicao inicial da RAM
                      00060                 
  00000020            00061                 STATUS_TEMP                     ;Variavel para armazenamento do STATUS na interrupcao.
  00000021            00062                 W_TEMP                          ;Variavel para armazenamento de W na interrupcao.
  00000022            00063                 PULSO_seg
  00000023            00064                 TEMPO_gravar
  00000024            00065                 FLAG
  00000025            00066                 BOTAO                           ;biblioteca     USER
                      00067                 ;ENDERECO                       ;biblioteca E2PROM
                      00068                 ;DADO
  00000026            00069                  ENDERECO               ;Biblioteca MemoriasDec                                         
                                       *
  00000027            00070                  ENDERECO_H     ;Biblioteca MemoriasDec                                                *
  00000028            00071                  ENDERECO_L     ;Biblioteca MemoriasDec                                                 
                               *
  00000029            00072                  DADO                   ;Biblioteca MemoriasDec                                         
                                       *
  0000002A            00073                  DADO_H         ;Biblioteca MemoriasDec                                                 
                               *
  0000002B            00074                  DADO_L         ;Biblioteca MemoriasDec                                                 
                               *
  0000002C            00075                  AUXTECLA               ;Biblioteca MemoriasDec 
  0000002D            00076                 AUX                                     ;biblioteca PWM
  0000002E            00077                 TEMPO_xms                       ;biblioteca DISPLAY
  0000002F            00078                 xxx_PRINT                       ;biblioteca DISPLAY
  00000030            00079                 TEMPO_ms                        ;biblioteca DISPLAY
  00000031            00080                 TEMPO_us                        ;biblioteca DISPLAY
  00000032            00081                 AUXTRANS                        ;biblioteca TERMINAL
  00000033            00082                 xxx_SEND                        ;biblioteca TERMINAL
  00000034            00083                 ENDERECO1                       ;biblioteca USER
MPASM  5.51                           APS.ASM   7-1-2016  15:53:01         PAGE  3


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

  00000035            00084                 ENDERECO2
  00000036            00085                 TEMPERATURA_c           ;biblioteca lm35
  00000037            00086                 TEMPERATURA
  00000038            00087                 TEMPERATURA_d           ;biblioteca lm35
  00000039            00088                 TEMPERATURA_u           ;biblioteca lm35
  0000003A            00089                 TEMPERATURA_m           ;biblioteca lm35
  0000003B            00090                 TEMPERATURA_x           ;biblioteca lm35
  0000003C            00091                 MULT_1                          ;biblioteca math
  0000003D            00092                 MULT_2                          ;biblioteca math
  0000003E            00093                 PRODUTO                         ;biblioteca math
  0000003F            00094                 PRODUTO_H
  00000040            00095                 PRODUTO_L
  00000041            00096                 MULT_TMP
  00000042            00097                 MULT_1_H                                                                
  00000043            00098                 MULT_1_L
  00000044            00099                 QUOCIENTE_H
  00000045            00100                 QUOCIENTE_L     
  00000046            00101                 DIVIDENDO_H
  00000047            00102                 DIVIDENDO_L
  00000048            00103                 RESTOTMP_H
  00000049            00104                 RESTOTMP_L
  0000004A            00105                 RESTO_H
  0000004B            00106                 RESTO_L 
  0000004C            00107                 DIVISOR_H
  0000004D            00108                 DIVISOR_L
  0000004E            00109                 NUM1
  0000004F            00110                 NUM2
  00000050            00111                 NUM3
  00000051            00112                 NUM4
  00000052            00113                 NUM5    
  00000053            00114                 DIVIDENDOTMP_H  
  00000054            00115                 DIVIDENDOTMP_L  
  00000055            00116                 DIVISORTMP_H    ;biblioteca math
  00000056            00117                 DIVISORTMP_L    ;biblioteca math
                      00118                                         
                      00119         ENDC
                      00120 ;----------------------------------------------------------------------------
                      00121 ;                       DEFINICAO DOS BANCOS DA RAM                        
                      00122 
                      00123 BANK0   MACRO                                   ;Seleciona Bank0 de memória.
                      00124                                 bcf STATUS,RP1
                      00125                                 bcf     STATUS,RP0
                      00126                 ENDM                                    ;Fim da MACRO Bank0
                      00127 
                      00128 BANK1   MACRO                                   ;Seleciona Bank1 de memória.
                      00129                                 bcf STATUS,RP1
                      00130                                 bsf     STATUS,RP0
                      00131                 ENDM                                    ;Fim da MACRO Bank1.
                      00132                 
                      00133 BANK2   MACRO                                   ;SELECIONA BANK2 DE MEMÓRIA.
                      00134                                 bsf STATUS,RP1
                      00135                                 bcf     STATUS,RP0
                      00136                 ENDM                                    ;FIM DA MACRO BANK2.
MPASM  5.51                           APS.ASM   7-1-2016  15:53:01         PAGE  4


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00137 
                      00138 BANK3   MACRO                                   ;SELECIONA BANK3 DE MEMÓRIA.
                      00139                                 bsf STATUS,RP1
                      00140                                 bsf     STATUS,RP0
                      00141                 ENDM                                    ;FIM DA MACRO BANK3.
                      00142 
                      00143 ;----------------------------------------------------------------------------
                      00144 ;                                FLAGS 
                      00145 
                      00146 ;----------------------------------------------------------------------------
                      00147 ;                                ENTRADAS                                  
                      00148 ;Pinos que serao utilizados como entrada.
                      00149 #DEFINE         RS                      PORTE,0         ;Selecao de registro
                      00150 #DEFINE         ENABLE          PORTE,1         ;Inicia o ciclo de leitura/escrita
                      00151 #DEFINE         TECLA           PORTB           ;Colunas do teclado multiplexado.
                      00152 
                      00153 ;----------------------------------------------------------------------------
                      00154 ;                                 SAIDAS                                   
                      00155 ;Pinos que serao utilizados como saida.
                      00156 
                      00157 #DEFINE         LINHA           PORTC           ;Linhas do teclado multiplexado
                      00158 
                      00159 ;----------------------------------------------------------------------------
                      00160 
                      00161 
                      00162 ;----------------------------------------------------------------------------
                      00163 ;                    VETOR DE RESET DO MICROCONTROLADOR                    
                      00164 
0000                  00165         ORG     0x00                    ;Endereco inicial de processamento.
0000   281F           00166         goto    Inicio
                      00167 
                      00168 ;----------------------------------------------------------------------------
                      00169 ;                VETOR DE INTERRUPCAO DO MICROCONTROLADOR                  
                      00170 
                      00171 
0004                  00172         ORG     0x04                    ;Endereco inicial de interrupcao
                      00173 
0004                  00174 Interrupcao:                            ;Funcao para tratamento de interrupcao
                      00175 
0004   00A1           00176         movwf   W_TEMP                  ;Guarda o valor de W
0005   0E03           00177         swapf   STATUS,W                ;Inverte os nibbles para nao ter risco de altera-los
0006   00A0           00178         movwf   STATUS_TEMP             ;Guarda o STATUS
                      00179         
0007   1A8C           00180         btfsc   PIR1,RCIF
0008   280D           00181         goto    RECEPCAO
                      00182         
0009   190B           00183         btfsc   INTCON,2                ;Testa se foi a interrupcao de TMR0
000A   2811           00184         goto    TEMPO
                      00185         
000B   1410           00186         bsf             T1CON,0
                      00187         
000C   281A           00188         goto    INT_OUT
                      00189         
MPASM  5.51                           APS.ASM   7-1-2016  15:53:01         PAGE  5


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

000D                  00190 RECEPCAO:
000D   1724           00191         bsf             FLAG,6
000E   081A           00192         movf    RCREG,W
000F   00B5           00193         movwf   ENDERECO2
0010   281A           00194         goto    INT_OUT
                      00195         
0011                  00196 TEMPO:
0011   110B           00197         bcf             INTCON,2                ;Sim, limpa a flag
0012   3006           00198         movlw   .6                              ;Reinicia TMR0 com 6, para contar 250
0013   0081           00199         movwf   TMR0            
                      00200         
Message[305]: Using default destination of 1 (file).
0014   0BA2           00201         decfsz  PULSO_seg               ;Decrementa PULSO_seg
0015   281A           00202         goto    INT_OUT                 ;Se nao for 0, vai para o final da funcao
                      00203         
0016   30FA           00204         movlw   .250                    ;Se for 0, reinicia ele pra contar mais 1 segundo
0017   00A2           00205         movwf   PULSO_seg
0018   15A4           00206         bsf             FLAG,3
                      00207         
Message[305]: Using default destination of 1 (file).
0019   0AA3           00208         incf    TEMPO_gravar    
                      00209         
001A                  00210 INT_OUT:
001A   0E20           00211         swapf    STATUS_TEMP,W
001B   0083           00212         movwf    STATUS         ;Recupera STATUS
001C   0EA1           00213         swapf    W_TEMP,F
001D   0E21           00214         swapf    W_TEMP,W       ;Recupera W
                      00215 
001E   0009           00216         retfie
                      00217         
                      00218 ;----------------------------------------------------------------------------
                      00219 ;               CONFIGURACOES INICIAIS DE HARDWARE E SOFTWARE              
                      00220 ; Nesta rotina sao inicializadas as portas de I/O do microcontrolador, os
                      00221 ; perifericos que serao usados e as configuracoes dos registradores 
                      00222 ; especiais (SFR). 
                      00223 ;----------------------------------------------------------------------------
001F                  00224 Inicio:
                      00225         
                      00226         BANK1                                   ;Altera para o Bank1.
001F   1303               M                                 bcf STATUS,RP1
0020   1683               M                                 bsf     STATUS,RP0
0021   300F           00227         movlw   B'00001111'
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0022   0085           00228         movwf   TRISA
0023   300F           00229         movlw   B'00001111'
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0024   0086           00230         movwf   TRISB
0025   30C0           00231         movlw   B'11000000'
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0026   0087           00232         movwf   TRISC
0027   3000           00233         movlw   B'00000000'
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0028   0088           00234         movwf   TRISD                   ;Toda PORTD e saida.
MPASM  5.51                           APS.ASM   7-1-2016  15:53:01         PAGE  6


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0029   3000           00235         movlw   B'00000000'
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
002A   0089           00236         movwf   TRISE
                      00237         
002B   3001           00238         movlw   B'00000001'
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
002C   008C           00239         movwf   PIE1                    ;Configuracao PIE1
                      00240                                                         ;interrupcoes
                      00241                                                         ;5: enable USART receive (RCIE)
                      00242                                                         ;4: enable USART transmit (TXIE)
002D   30E0           00243         movlw   B'11100000'
002E   008B           00244         movwf   INTCON
002F   3084           00245         movlw   B'10000100'
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0030   009F           00246         movwf   ADCON1                  ;sera reconfigurado de acordo com a funcao
0031   30C5           00247         MOVLW   B'11000101'     
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0032   0081           00248         MOVWF   OPTION_REG
0033   3024           00249         movlw   B'00100100'
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0034   0098           00250         movwf   TXSTA                   ;Configuracao TXSTA
                      00251                                                         ;7: p/ assincrono don't care (CSRC)
                      00252                                                         ;6: 9-bit transmt enable bit(TX9)
                      00253                                                         ;5: transmit disable bit (setara TXIF) (TXEN)
                      00254                                                         ;4: USART mode - 0 = assincrono (SYNC)
                      00255                                                         ;2: baud rate - 1 = high speed (BRGH)
                      00256                                                         ;1: transmit shift register - 1 = TSR empty (TRM
                            T)
                      00257                                                         ;0: bit de paridade (TX9D)
0035   3033           00258         movlw   .51
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0036   0099           00259         movwf   SPBRG                   ;De acordo com a tabela do datasheet este registrador
                      00260                                                         ;e carregado com 51, para ter um baud rate de 19
                            200 bps
                      00261 
                      00262         BANK0                                   ;Retorna para o Bank0.
0037   1303               M                                 bcf STATUS,RP1
0038   1283               M                                 bcf     STATUS,RP0
0039   3090           00263         movlw   B'10010000'
003A   0098           00264         movwf   RCSTA                   ;Configuracao RCSTA
                      00265                                                         ;7: serial port enable - RC7 e RC6 (SPEN)
                      00266                                                         ;6: 0 = 8bit reception (RX9)
                      00267                                                         ;5: assincrono - don't care (SREN)
                      00268                                                         ;4: enable continous recieve (CREN)
                      00269                                                         ;3: adress detect - disable (ADDEN)
                      00270                                                         ;2: framming error (FERR)
                      00271                                                         ;1: overrun error (OERR)
                      00272                                                         ;0: bit de paridade (RX9D)
003B   3030           00273         movlw   B'00110000'
003C   0090           00274         movwf   T1CON
003D   308D           00275         movlw   B'10001101'
003E   009F           00276         movwf   ADCON0                  
                      00277                                                         
MPASM  5.51                           APS.ASM   7-1-2016  15:53:01         PAGE  7


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

003F   30FA           00278         movlw   .250
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0040   0092           00279         movwf   PR2                             ;Carrega PR2 com 250 - freq (16 kHz)
0041   3004           00280         movlw   B'00000100'
0042   0092           00281         movwf   T2CON                   ;Prescaler 1:1 (bit 0 e 1), ON (bit 2) TMR2
0043   300C           00282         movlw   B'00001100'
0044   0097           00283         movwf   CCP1CON                 ;Configura o modulo como PWM
                      00284         
0045   3000           00285         movlw   B'00000000'                     ;Limpa os registradores do PWM
0046   0095           00286         movwf   CCPR1L
0047   1297           00287         bcf             CCP1CON,5
0048   1217           00288         bcf             CCP1CON,4
                      00289         
0049   30FF           00290         movlw   B'11111111'
004A   008F           00291         movwf   TMR1H
004B   3000           00292         movlw   B'00000000'
004C   008E           00293         movwf   TMR1L
                      00294         
004D   3000           00295         movlw   B'00000000'             
004E   0088           00296         movwf   PORTD                   ;Inicializa a PORTD.
                      00297         
004F   3006           00298         movlw   .6                              ;Inicia timer com 6, para contar 250.
0050   0081           00299         movwf   TMR0
0051   30FA           00300         movlw   .250                    ;Inicia com 250, para fechar 1s.
0052   00A2           00301         movwf   PULSO_seg
0053   3000           00302         movlw   .0
0054   00A3           00303         movwf   TEMPO_gravar
                      00304         
0055   3001           00305         movlw   .1
0056   00B3           00306         movwf   xxx_SEND
0057   3001           00307         movlw   .1
0058   00AF           00308         movwf   xxx_PRINT
                      00309         
0059   01A4           00310         clrf    FLAG
                      00311 
005A   20B8           00312         call    ON_LCD
005B   210E           00313         call    INICIALIZA_E2PROM 
                      00314         
005C   3000           00315         movlw   0X00
005D   00A6           00316         movwf   ENDERECO
                      00317         
                      00318 ;----------------------------------------------------------------------------
                      00319 ;                     INICIALIZACAO DA RAM                       
                      00320 
                      00321 ;  LIMPA DE TODA A RAM DO BANC0 0, INDO DE 0X20 A 0X7F.
005E   3020           00322         movlw   0x20
005F   0084           00323         movwf   FSR                             ;APONTA O ENDEREÇAMENTO INDIRETO PARA
                      00324                                                         ;A PRIMEIRA POSIÇAO DA RAM.
0060                  00325 LIMPA_RAM
0060   0180           00326         clrf    INDF                    ;LIMPA A POSIÇAO ATUAL.
0061   0A84           00327         incf    FSR,F                   ;INCREMENTA PONTEIRO P/ A PROX. POS.
0062   0804           00328         movf    FSR,W
0063   3A80           00329         xorlw   0x80                    ;COMPARA PONTEIRO COM A ULT. POS. +1.
MPASM  5.51                           APS.ASM   7-1-2016  15:53:01         PAGE  8


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0064   1D03           00330         btfss   STATUS,Z                ;JA LIMPOU TODAS AS POSIÇOES?
0065   2860           00331         goto    LIMPA_RAM               ;NAO, LIMPA A PROXIMA POSICAO.
                      00332                                                         ;SIM, CONTINUA O PROGRAMA.
                      00333 
                      00334 ;----------------------------------------------------------------------------
                      00335 ;                                       INICIALIZACAO DE VARIAVEIS E PERIFÉRICOS                       
                      00336 ;Cristal de 16MHz.
                      00337 
                      00338 
                      00339 
                      00340 ;----------------------------------------------------------------------------
                      00341 ;                                       ROTINA PRINCIPAL         
                      00342 ;Rotina principal do programa.                   
                      00343 ;----------------------------------------------------------------------------
0066                  00344 Main:
                      00345         
                      00346 
Warning[207]: Found label after column 1. (ESTADO1)
0066                  00347         ESTADO1:
0066   2075           00348                 call    SENSOR  
                      00349         
Warning[207]: Found label after column 1. (ESTADO2)
0067                  00350         ESTADO2:
0067   20FB           00351                 call    IMPRIME
                      00352         
Warning[207]: Found label after column 1. (ESTADO3)
0068                  00353         ESTADO3:
0068   19A4           00354                 btfsc   FLAG,3
0069   2202           00355                 call    SEND
                      00356 
                      00357         
Warning[207]: Found label after column 1. (ESTADO4)
006A                  00358         ESTADO4:
006A   2133           00359                 call    PWM
                      00360                 
Warning[207]: Found label after column 1. (ESTADO5)
006B                  00361         ESTADO5:
006B   0823           00362                 movf    TEMPO_gravar,W
006C   3A05           00363                 xorlw   .5
006D   1D03           00364                 btfss   STATUS,Z
006E   2872           00365                 goto    ESTADO6
006F   214D           00366                 call    MEMORIA
0070   3000           00367                 movlw   .0
0071   00A3           00368                 movwf   TEMPO_gravar
                      00369                 
Warning[207]: Found label after column 1. (ESTADO6)
0072                  00370         ESTADO6:
0072   1B24           00371                 btfsc   FLAG,6
0073   2256           00372                 call    USUARIO
                      00373         
0074   2866           00374         goto    Main
                      00375 
                      00376 ;---------------------------------------------------------------------------------
MPASM  5.51                           APS.ASM   7-1-2016  15:53:01         PAGE  9


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00377 ;                               FIM DO PROGRAMA                             
                      00378 #INCLUDE <lm35.inc>
                      00001 ;----------------------------------------------------------------------------
                      00002 ;                                               BIBLIOTECA PARA SENSOR LM35                             
                                                    |
                      00003 ; Disciplina: Microcontroladores                                                                        
                                            |
                      00004 ; Desenvolvido por: Rodrigo Antonio Sbardeloto Kraemer                                          |
                      00005 ;                                       Mateus Milani                                                   
                                                            |
                      00006 ;Data:  30/06/2016                                                                                      
                                                            |
                      00007 ;----------------------------------------------------------------------------
                      00008 ;                             DESCRICAO GERAL                             
                      00009 
                      00010 ;Esta biblioteca le os valores de tensao do sensor de temperatura LM35 (pino 
                      00011 ; RA3) e converte para temperatura. Faixa de operacao (+150 ate -55)
                      00012 ;Utiliza a Biblioteca Atirmetica para fazer as contas.
                      00013 ;----------------------------------------------------------------------------
                      00014 ;* Função ESPERA_CONVERSAO                                                                            
                               
                      00015 ;* Função COPIA_RES_CONVERSAO                                                           
                      00016 ;* Função COPIA_RESOLUCAO                                                                        
                      00017 ;* Função DECODE_DIGITO                                                                  
                      00018 
                      00019 ;----------------------------------------------------------------------------
                      00020 ;                       VARIAVEIS A SEREM DECLARADAS NO CODIGO PRINCIPAL
                      00021 
                      00022 ;       TEMPERATURA_c - centena
                      00023 ;       TEMPERATURA_d - dezena
                      00024 ;       TEMPERATURA_u - unidade
                      00025 ;       TEMPERATURA_x1
                      00026 ;       TEMPERATURA_x - casa apos a virgula
                      00027 ;                                   Variaveis que armazenam a temperatura, ja convertida, 
                      00028 ;                                       pronta para ser armazenada e exibida.
                      00029 ;       NUM1_H
                      00030 ;       NUM1_L          Variaveis para guardar os valores convertidos pelo A/D
                      00031 ;                                       que sao armazenados em ADRESH (bank0) e ADRESL (bank1).
                      00032 ;
                      00033 ;----------------------------------------------------------------------------
                      00034 ;               REGISTRADORES A SEREM CONFIGURADOS NO CODIGO PRINCIPAL
                      00035 
                      00036 ;       BANK1
                      00037 ;       ADCON1(10000010)                ;7:     RIGHT justified
                      00038                                                         ;3-0:   Analog (RA3)
                      00039                                                         ;               Analog (RA2)
                      00040                                                         ;               Analog (RA1)
                      00041                                                         ;               Analog (RA0)
                      00042 
                      00043 ;       BANK0
                      00044 ;       ADCON0(10001000)                ;Configuracao do conversor ADC
                      00045                                                         ;7-6: Fosc/32
                      00046                                                         ;5-3: channel 1 (RA1, AN1)
MPASM  5.51                           APS.ASM   7-1-2016  15:53:01         PAGE 10


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00047                                                         ;2: Convertendo ou nao
                      00048                                                         ;1: nao implementado
                      00049                                                         ;0: ligado ou desligado (manter desligado, 
                      00050                                                         ;economiza energia)
                      00051                                                         
                      00052 
                      00053 
                      00054 
                      00055 ;----------------------------------------------------------------------------
0075                  00056 SENSOR:
0075   151F           00057         bsf             ADCON0,2                
                      00058 
                      00059 ;----------------------------------------------------------------------------
                      00060 ;                      FUNÇÃO ESPERA_CONVERSAO                           
                      00061 ;                                                                          
                      00062 ; Esta rotina deve ser chamada quando uma conversão A/D for iniciada.                                  
                                                                               
                      00063 ; O programa fica preso em um loop até que a conversão termine,   
                      00064 ; para então retornar.                                                                                 
                              
                      00065 ; Não possui argumentos nem retornos.                                             
                      00066 ;----------------------------------------------------------------------------
0076                  00067 ESPERA_CONVERSAO:
0076   191F           00068         btfsc   ADCON0,2                                ;Testa FLAG
0077   2876           00069         goto    ESPERA_CONVERSAO        ;Enquanto ADCON0,2 = 1 a Conversão 
                      00070                                                                 ;ainda não terminou
                      00071         
                      00072 ;----------------------------------------------------------------------------
                      00073 ;                    FUNÇÃO COPIA_RES_CONVERSAO                      
                      00074 ;                                                                          
                      00075 ; Esta rotina copia o resultado de uma coversão A/D para as       
                      00076 ; variáveis de entrada da função MULTIPLICA_10x8 da Biblioteca          
                      00077 ; Aritmetica.                                                                                           
                                       
                      00078 ;-----------------------------------------------------------------
                      00079 ; Para ADRESH e ADRESL Justificados a Direita                     
                      00080 ;-----------------------------------------------------------------
                      00081 ; ADRESH e ADRESL Registers: Datasheet Pag 116                                     
                      00082 ; Os registradores ADRESH e ADRESL guardam a parte alta e a        
                      00083 ; parte baixa, respectivamente, do resultado da conversão A/D.    
                      00084 ;-----------------------------------------------------------------
                      00085 ; Esta função copia: ADRESH -> NUM1_H                                                
                      00086 ;                                 ADRESL -> NUM1_L                                                 
                      00087 ;----------------------------------------------------------------------------
0078                  00088 COPIA_RES_CONVERSAO:
                      00089         BANK1
0078   1303               M                                 bcf STATUS,RP1
0079   1683               M                                 bsf     STATUS,RP0
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
007A   081E           00090         movf    ADRESL,W
                      00091 
                      00092         BANK0
007B   1303               M                                 bcf STATUS,RP1
MPASM  5.51                           APS.ASM   7-1-2016  15:53:01         PAGE 11


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

007C   1283               M                                 bcf     STATUS,RP0
007D   00C3           00093         movwf   MULT_1_L
007E   081E           00094         movf    ADRESH,W
007F   00C2           00095         movwf   MULT_1_H
                      00096         
0080   0843           00097         movf    MULT_1_L,W
0081   00B7           00098         movwf   TEMPERATURA
                      00099 
                      00100 ;----------------------------------------------------------------------------
                      00101 ;                       FUNÇÃO COPIA_RESOLUCAO                           
                      00102 ;                                                                          
                      00103 ; Esta rotina copia a resolução do conversor A/D, (que foi        
                      00104 ; definida aqui mesmo), para uma variável de entrada da função    
                      00105 ; MULTIPLICA_10x8 da Biblioteca Aritmetica2.                                       
                      00106 ;-----------------------------------------------------------------
                      00107 ; Nesta rotina a resolução do coversor A/D será setada, conforme: 
                      00108 ; Resoloução = Vref/L                                                    
                      00109 ; Onde: Vref: Fundo de escala                                     
                      00110 ;       L:    Niveis de Quantização = (2^N)-1                     
                      00111 ;       N:    Número de bits                                      
                      00112 ;-----------------------------------------------------------------
                      00113 ; Esta função copia: Resolução(Literal) -> MULT_2                              
                      00114 ;----------------------------------------------------------------------------
0082                  00115 COPIA_RESOLUCAO
0082   3005           00116         movlw   .5              
0083   00BD           00117         movwf   MULT_2  
                      00118 
0084   21B4           00119         call    MULTIPLICA_10x8
                      00120         
                      00121         
                      00122 ;----------------------------------------------------------------------------
                      00123 ;                       FUNÇÃO DECODE_DIGITO                     
                      00124 ;                                                                          
                      00125 ; Esta rotina Isola os Dígitos do resultado da Conversão A/D      
                      00126 ; para mandar, individualmente para o LCD (deve somar 48 
                      00127 ; para converter para ASCII)                                       
                      00128 ; --------------------------------------------------------------- 
                      00129 ; Variáveis de Entrada:          |   Variáveis de Saída:        
                      00130 ;     (Argumentos)               |       (Retornos)                        
                      00131 ; PRODUTO_H                      | NUM1                                    
                      00132 ; PRODUTO_L                          | NUM2                                        
                      00133 ;                                        | NUM3                                                    
                      00134 ;                                        | NUM4                                                    
                      00135 ;                                        | NUM5                                                    
                      00136 ;-----------------------------------------------------------------
                      00137 ; Esta rotina deve ser chamada depois que o resultado da          
                      00138 ; Conversão A/D for multiplicado pela Resolução, através da                 
                      00139 ; função MULTIPLICA_10x8 da Biblioteca Aritmetica2. O retorno    
                      00140 ; desse produto será argumento desta rotina.                                     
                      00141 ;----------------------------------------------------------------------------
0085                  00142 DECODE_DIGITO
                      00143 ;divide por 10MIL       0x2710
0085   3027           00144         movlw   0x27    ;10000
MPASM  5.51                           APS.ASM   7-1-2016  15:53:01         PAGE 12


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0086   00CC           00145         movwf   DIVISOR_H
0087   3010           00146         movlw   0x10    ;16
0088   00CD           00147         movwf   DIVISOR_L
0089   0840           00148         movf    PRODUTO_L,W
008A   00C7           00149         movwf   DIVIDENDO_L
008B   083F           00150         movf    PRODUTO_H,W
008C   00C6           00151         movwf   DIVIDENDO_H
008D   21CD           00152         call    DIVIDE_16x16
008E   0845           00153         movf    QUOCIENTE_L,W
008F   3E30           00154         addlw   .48
0090   00BA           00155         movwf   TEMPERATURA_m
                      00156 
                      00157 ;divide por 1MIL        0x3E8
0091   3003           00158         movlw   0x03
0092   00CC           00159         movwf   DIVISOR_H
0093   30E8           00160         movlw   0xE8
0094   00CD           00161         movwf   DIVISOR_L
0095   084B           00162         movf    RESTO_L,W
0096   00C7           00163         movwf   DIVIDENDO_L
0097   084A           00164         movf    RESTO_H,W
0098   00C6           00165         movwf   DIVIDENDO_H
0099   21CD           00166         call    DIVIDE_16x16
009A   0845           00167         movf    QUOCIENTE_L,W
009B   3E30           00168         addlw   .48
009C   00B6           00169         movwf   TEMPERATURA_c
                      00170 
                      00171 ;divide por 100
009D   3064           00172         movlw   .100
009E   00CD           00173         movwf   DIVISOR_L
009F   01CC           00174         clrf    DIVISOR_H
00A0   084B           00175         movf    RESTO_L,W
00A1   00C7           00176         movwf   DIVIDENDO_L
00A2   084A           00177         movf    RESTO_H,W
00A3   00C6           00178         movwf   DIVIDENDO_H
00A4   21CD           00179         call    DIVIDE_16x16
00A5   0845           00180         movf    QUOCIENTE_L,W
00A6   3E30           00181         addlw   .48
00A7   00B8           00182         movwf   TEMPERATURA_d
                      00183 
                      00184 ;divide por 10
00A8   300A           00185         movlw   .10
00A9   00CD           00186         movwf   DIVISOR_L
00AA   01CC           00187         clrf    DIVISOR_H
00AB   084B           00188         movf    RESTO_L,W
00AC   00C7           00189         movwf   DIVIDENDO_L
00AD   084A           00190         movf    RESTO_H,W
00AE   00C6           00191         movwf   DIVIDENDO_H
00AF   21CD           00192         call    DIVIDE_16x16
00B0   0845           00193         movf    QUOCIENTE_L,W
00B1   3E30           00194         addlw   .48
00B2   00B9           00195         movwf   TEMPERATURA_u
                      00196         
00B3   084B           00197         movf    RESTO_L,W
MPASM  5.51                           APS.ASM   7-1-2016  15:53:01         PAGE 13


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

00B4   3E30           00198         addlw   .48
00B5   00BB           00199         movwf   TEMPERATURA_x
                      00200         
00B6   01CB           00201         clrf    RESTO_L
00B7   0008           00202         return  
                      00203         
                      00204         
                      00205         
                      00206         
                      00207         
                      00208         
                      00209         
                      00210         
                      00211         
                      00212         
                      00213         
                      00214         
                      00215         
                      00216         
                      00217         
                      00218         
                      00219         
                      00220         
                      00221         
                      00222         
                      00223         
                      00224         
                      00225         
                      00226         
                      00227         
                      00379 #INCLUDE <display.inc>
                      00001 ;----------------------------------------------------------------------------
                      00002 ;                                               BIBLIOTECA PARA LCD                                     
                                                            |
                      00003 ; Disciplina: Microcontroladores                                                                        
                                            |
                      00004 ; Desenvolvido por: Rodrigo Antonio Sbardeloto Kraemer                                          |
                      00005 ;                                       Mateus Milani                                                   
                                                            |
                      00006 ;Data:  30/06/2016                                                                                      
                                                            |
                      00007 ;----------------------------------------------------------------------------
                      00008 ;                             DESCRICAO GERAL                             
                      00009 
                      00010 ;Esta biblioteca imprime o valor da temperatura medido pelo sensor.
                      00011 ;----------------------------------------------------------------------------
                      00012 ;Funcao ON_LCD
                      00013 ;Funcao ESCREVE
                      00014 ;Funcao DELAY
                      00015 
                      00016 ;----------------------------------------------------------------------------
                      00017 ;                       VARIAVEIS A SEREM DECLARADAS NO CODIGO PRINCIPAL
                      00018 
MPASM  5.51                           APS.ASM   7-1-2016  15:53:01         PAGE 14


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00019 ;       TEMPO_xms - tempo a ser determinado
                      00020 ;       TEMPO_ms - tempo a ser contado, em milisegundos
                      00021 ;
                      00022 ;----------------------------------------------------------------------------
                      00023 ;               REGISTRADORES A SEREM CONFIGURADOS NO CODIGO PRINCIPAL
                      00024 
                      00025 ;       T1CON(00110000) - 5,4: Prescaler em 1:8
                      00026 ;                                       - 3: oscillator off
                      00027 ;                                       - 1: clock interno
                      00028 ;                                       - 0: stop TMR1
                      00029 ;       PIE1(00000001) - Habilita TMR1
                      00030 ;       TMR1H = 0b11111111;
                      00031 ;       TMR1L = 0b11010111;             conta 40us
                      00032 ;       INTCON(11000000) - Habilita interrupcoes
                      00033 ;----------------------------------------------------------------------------
                      00034 ;               PINOS A SEREM CONFIGURADOS NO CODIGO PRINCIPAL
                      00035 
                      00036 ;SAIDAS
                      00037 ;       PORTE,0 - RS (selecao de registro)
                      00038 ;       PORTE,1 - ENABLE (inicia o ciclo de leitura/escrita)
                      00039 
                      00040 ;ENTRADAS
                      00041 
                      00042 ;----------------------------------------------------------------------------
                      00043 ;                                                               FUNCAO ON_LCD
                      00044 ;
                      00045 ;Protocolo para inicializacao do LCD, deixando-o preparado para uso.
                      00046 ;----------------------------------------------------------------------------
00B8                  00047 ON_LCD:                         
                      00048 
00B8   1009           00049         bcf     RS                      ; SELECIONA O DISPLAY P/ COMANDOS
00B9   3038           00050         movlw   0X38            ; ESCREVE COMANDO 0X38 PARA
00BA   20F2           00051         call    ESCREVE         ; INICIALIZACAO
00BB   300C           00052         movlw   .12
00BC   20E9           00053         call    DELAY           ; DELAY DE 12MS
                      00054         
00BD   3038           00055         movlw   0X38            ; ESCREVE COMANDO 0X38 PARA
00BE   20F2           00056         call    ESCREVE         ; INICIALIZACAO
00BF   300C           00057         movlw   .12
00C0   20E9           00058         call    DELAY
00C1   3006           00059         movlw   0X06            ; ESCREVE COMANDO 0X06 PARA
00C2   20F2           00060         call    ESCREVE         ; INICIALIZACAO
00C3   300C           00061         movlw   .12
00C4   20E9           00062         call    DELAY
                      00063         
00C5   300C           00064         movlw   0X0C            ; ESCREVE COMANDO PARA
00C6   20F2           00065         call    ESCREVE         ; INTERFACE DE 8 VIAS DE DADOS
                      00066                                                 ; DISPLAY: ON
                      00067                                                 ; BLINK: OFF
                      00068                                                 ; CURSOR: OFF
00C7   300C           00069         movlw   .12
00C8   20E9           00070         call    DELAY
                      00071         
MPASM  5.51                           APS.ASM   7-1-2016  15:53:01         PAGE 15


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

00C9   3001           00072         movlw   0X01            ; ESCREVE COMANDO PARA
00CA   20F2           00073         call    ESCREVE ; LIMPAR TODO O DISPLAY
00CB   300C           00074         movlw   .12
00CC   20E9           00075         call    DELAY           ; DELAY DE 12MS
                      00076         
00CD   1409           00077         bsf             RS
                      00078         
00CE   3083           00079         movlw   0x83            ;Posiciona o cursor na primeira linha
00CF   1009           00080         bcf             RS
00D0   20F2           00081         call    ESCREVE
00D1   1409           00082         bsf             RS
                      00083 
00D2   3054           00084         movlw   'T'
00D3   20F2           00085         call    ESCREVE
00D4   3065           00086         movlw   'e'
00D5   20F2           00087         call    ESCREVE
00D6   306D           00088         movlw   'm'
00D7   20F2           00089         call    ESCREVE
00D8   3070           00090         movlw   'p'
00D9   20F2           00091         call    ESCREVE
00DA   3065           00092         movlw   'e'
00DB   20F2           00093         call    ESCREVE
00DC   3072           00094         movlw   'r'
00DD   20F2           00095         call    ESCREVE
00DE   3061           00096         movlw   'a'
00DF   20F2           00097         call    ESCREVE
00E0   3074           00098         movlw   't'
00E1   20F2           00099         call    ESCREVE
00E2   3075           00100         movlw   'u'
00E3   20F2           00101         call    ESCREVE
00E4   3072           00102         movlw   'r'
00E5   20F2           00103         call    ESCREVE
00E6   3061           00104         movlw   'a'
00E7   20F2           00105         call    ESCREVE
                      00106         
00E8   0008           00107         return
                      00108 
                      00109 ;----------------------------------------------------------------------------
                      00110 ;                                                               FUNCAO DELAY
                      00111 ;
                      00112 ;Rotina de delay generica. Deve-se entrar com o valor desejado em milisegundos
                      00113 ;----------------------------------------------------------------------------
00E9                  00114 DELAY:
00E9   00AE           00115         movwf   TEMPO_xms               
00EA   30FA           00116         movlw   .250                    
00EB   00B0           00117         movwf   TEMPO_ms                ;move 250 para a variavel TEMPO_ms
                      00118 
00EC                  00119 ESPERA:
00EC   0000           00120         nop                                     
Message[305]: Using default destination of 1 (file).
00ED   0BB0           00121         decfsz  TEMPO_ms                ;Decrementa a variavel para contar 1ms
00EE   28EC           00122         goto    ESPERA                  ;Se nao for zero volta para o inicio da funcao 
                      00123         
MPASM  5.51                           APS.ASM   7-1-2016  15:53:01         PAGE 16


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

Message[305]: Using default destination of 1 (file).
00EF   0BAE           00124         decfsz  TEMPO_xms               ;Decrementa a variavel para multiplicar o 1ms
00F0   28EC           00125         goto    ESPERA  
                      00126         
00F1   0008           00127         return
                      00128 
                      00129 ;----------------------------------------------------------------------------
                      00130 ;                                                               FUNCAO ESCREVE
                      00131 ;
                      00132 ;Processo para escrita de um determinado dado, ou comando, no LCD. Para
                      00133 ;comando, deve-se limpar RS antes de chama-la e setar apos seu termino.
                      00134 ;----------------------------------------------------------------------------
                      00135 
00F2                  00136 ESCREVE:
00F2   1489           00137         bsf             ENABLE           
00F3   0088           00138         movwf   PORTD           
00F4   1089           00139         bcf     ENABLE          
                      00140         
00F5   30FA           00141         movlw   .250            ;Aguarda um tempo de 250us para estabilizacao.
00F6   00B1           00142         movwf   TEMPO_us
00F7   0000           00143         nop
00F8   0BB1           00144         decfsz  TEMPO_us,f
00F9   28F7           00145         goto    $-2
                      00146         
00FA   0008           00147         return
                      00148 ;----------------------------------------------------------------------------
                      00149 ;                                                               FUNCAO IMPRIME
                      00150 ;
                      00151 ;Imprime na tela do LCD no seguinte formato
                      00152 ;linha 1 - Temperatura (centralizado)
                      00153 ;linha 2 - 35.0 ºC (centralizado)
                      00154 ;----------------------------------------------------------------------------
00FB                  00155 IMPRIME:
00FB   30C4           00156         movlw   0xC4            ;Posiciona o cursor na segunda linha
00FC   1009           00157         bcf             RS
00FD   20F2           00158         call    ESCREVE
00FE   1409           00159         bsf             RS
                      00160         
00FF   0836           00161         movf    TEMPERATURA_c,W
0100   20F2           00162         call    ESCREVE
                      00163         
0101   0838           00164         movf    TEMPERATURA_d,W
0102   20F2           00165         call    ESCREVE
                      00166         
0103   0839           00167         movf    TEMPERATURA_u,W
0104   20F2           00168         call    ESCREVE
                      00169         
0105   302E           00170         movlw   '.'
0106   20F2           00171         call    ESCREVE
                      00172 
0107   083B           00173         movf    TEMPERATURA_x,W
0108   20F2           00174         call    ESCREVE
                      00175                 
MPASM  5.51                           APS.ASM   7-1-2016  15:53:01         PAGE 17


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0109   3020           00176         movlw   ' '
010A   20F2           00177         call    ESCREVE
                      00178 
010B   3043           00179         movlw   'C'
010C   20F2           00180         call    ESCREVE
                      00181 
010D   0008           00182         return
                      00183 
                      00184 ;* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
                      00185 ;*                    FUN??O INICIALIZA_E2PROM                         *
                      00186 ;*                                                                         *
                      00187 ;* Esta Fun??o escreve 0x00 em todas as posi??es da mem?ria        * 
                      00188 ;* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
010E                  00189 INICIALIZA_E2PROM 
010E   3000           00190         movlw   .0
010F   00A9           00191         movwf   DADO
0110   00A6           00192         movwf   ENDERECO
0111   211A           00193         call    ESCR_E2PROM
                      00194 
0112   30FF           00195         movlw   .255
0113   00A6           00196         movwf   ENDERECO
0114   211A           00197         call    ESCR_E2PROM 
                      00198         
0115                  00199 LOOP_MEMORIA:
Message[305]: Using default destination of 1 (file).
0115   0BA6           00200         decfsz  ENDERECO
0116   2918           00201         goto    LIMPA_POSICAO
0117   0008           00202         return
                      00203 
0118                  00204 LIMPA_POSICAO
0118   211A           00205         call    ESCR_E2PROM 
0119   2915           00206         goto    LOOP_MEMORIA
                      00207 
                      00208 ;* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
                      00209 ;*                           FUN??O ESCR_E2PROM                            *
                      00210 ;*                                                                         *
                      00211 ;* Est? fun??o Recebe como Argumento um DADO e um ENDERECO, e faz  * 
                      00212 ;* a escrita na E2PROM do DADO na posi??o passada pelo ENDERECO    *
                      00213 ;* --------------------------------------------------------------- *
                      00214 ;* Vari?veis de Entrada:         |   Vari?veis de Sa?da:           *
                      00215 ;*     (Argumentos)              |       (Retornos)                        *
                      00216 ;* DADO                              |                                             *
                      00217 ;* ENDERECO                              |                                                 *
                      00218 ;* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
011A                  00219 ESCR_E2PROM 
                      00220 
011A   0829           00221         movf    DADO,W 
                      00222         BANK2                           ;BANKSEL EEDATA 
011B   1703               M                                 bsf STATUS,RP1
011C   1283               M                                 bcf     STATUS,RP0
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
011D   008C           00223         movwf   EEDATA 
                      00224         BANK0 
MPASM  5.51                           APS.ASM   7-1-2016  15:53:01         PAGE 18


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

011E   1303               M                                 bcf STATUS,RP1
011F   1283               M                                 bcf     STATUS,RP0
0120   0826           00225         movf    ENDERECO,W 
                      00226         BANK2                           ;BANKSEL EEADR 
0121   1703               M                                 bsf STATUS,RP1
0122   1283               M                                 bcf     STATUS,RP0
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0123   008D           00227         movwf   EEADR 
                      00228         BANK3                           ;BANKSEL EECON1 
0124   1703               M                                 bsf STATUS,RP1
0125   1683               M                                 bsf     STATUS,RP0
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0126   138C           00229         bcf             EECON1,EEPGD 
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0127   150C           00230         bsf             EECON1,WREN 
0128   3055           00231         movlw   0x55 
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0129   008D           00232         movwf   EECON2          ;OBRIGAT?RIO. 
012A   30AA           00233         movlw   0xAA 
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
012B   008D           00234         movwf   EECON2          ;OBRIGAT?RIO.
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
012C   148C           00235         bsf             EECON1,WR   ;INICIA ESCRITA. 
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
012D   188C           00236         btfsc   EECON1,WR 
012E   292D           00237         goto$-1 
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
012F   110C           00238         bcf             EECON1,WREN 
                      00239         BANK0 
0130   1303               M                                 bcf STATUS,RP1
0131   1283               M                                 bcf     STATUS,RP0
                      00240 
0132   0008           00241         return
                      00242 
                      00380 #INCLUDE <pot.inc>      
                      00001 ;----------------------------------------------------------------------------
                      00002 ;                                               BIBLIOTECA PARA LCD                                     
                                                            |
                      00003 ; Disciplina: Microcontroladores                                                                        
                                            |
                      00004 ; Desenvolvido por: Rodrigo Antonio Sbardeloto Kraemer                                          |
                      00005 ;                                       Mateus Milani                                                   
                                                            |
                      00006 ;Data:  30/06/2016                                                                                      
                                                            |
                      00007 ;----------------------------------------------------------------------------
                      00008 ;                             DESCRICAO GERAL                             
                      00009 
                      00010 ;Utiliza o canal AN3 para ler a tensao no potenciometro P1, 0 a 5V.
                      00011 ;Transfere a potencia para o PWM e controla a intensidade da lampada.
                      00012 ;----------------------------------------------------------------------------
                      00013 ;                            DEFINICAO DAS VARIAVEIS                      
                      00014 ;               AUX                                     ;Guarda valores LSB do conversor
MPASM  5.51                           APS.ASM   7-1-2016  15:53:01         PAGE 19


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00015 ;----------------------------------------------------------------------------
                      00016 ;                       REGISTRADORES A SEREM CONFIGURADOS NO CODIGO PRINCIPAL
                      00017         
                      00018 ;       
                      00019 ;       PWM
                      00020 ;       PR2(61)                 Carrega PR2 com 61 - freq (16 kHz)
                      00021 ;       T2CON(00000101) Prescaler 1:4 (bit 0 e 1), ON (bit 2) TMR2
                      00022 ;       CCP1CON(00001100)       Configura o modulo como PWM
                      00023 ;----------------------------------------------------------------------------
                      00024 ;                                                       INICIALIZACAO DE VARIAVEIS E PERIFÉRICOS       
                                            
                      00025 ;Cristal de 16MHz.
                      00026 ;       movlw   B'00000000'                     ;Limpa os registradores do PWM
                      00027 ;       movwf   CCPR1L
                      00028 ;       bcf             CCP1CON,5
                      00029 ;       bcf             CCP1CON,4
                      00030 ;----------------------------------------------------------------------------
                      00031 ;                                       FUNCAO PWM         
                      00032 ;
                      00033 ;Esta funcao configura o pwm, de acordo com o estado do potenciometro
                      00034 ;para controle da intensidade luminosa da lampada.                  
                      00035 ;----------------------------------------------------------------------------
0133                  00036 PWM:
0133   1007           00037         bcf             LINHA,0
                      00038         
Warning[207]: Found label after column 1. (TECLA_0)
0134                  00039         TECLA_0:                                        ;Ton - 0%
0134   1806           00040                 btfsc   TECLA,0
0135   293A           00041                 goto    TECLA_1
                      00042                 
0136   3000           00043                 movlw   B'00000000'             
0137   0095           00044                 movwf   CCPR1L
0138   1297           00045                 bcf             CCP1CON,5
0139   1217           00046                 bcf             CCP1CON,4               
                      00047                 
Warning[207]: Found label after column 1. (TECLA_1)
013A                  00048         TECLA_1:                                        ;Ton - 33%
013A   1886           00049                 btfsc   TECLA,1
013B   2940           00050                 goto    TECLA_2
                      00051                 
013C   3053           00052                 movlw   B'01010011'             
013D   0095           00053                 movwf   CCPR1L
013E   1697           00054                 bsf             CCP1CON,5
013F   1617           00055                 bsf             CCP1CON,4       
                      00056                 
Warning[207]: Found label after column 1. (TECLA_2)
0140                  00057         TECLA_2:                                        ;Ton - 66%
0140   1906           00058                 btfsc   TECLA,2
0141   2946           00059                 goto    TECLA_3
                      00060                 
0142   30A5           00061                 movlw   B'10100101'             
0143   0095           00062                 movwf   CCPR1L
0144   1297           00063                 bcf             CCP1CON,5
MPASM  5.51                           APS.ASM   7-1-2016  15:53:01         PAGE 20


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0145   1617           00064                 bsf             CCP1CON,4       
                      00065                 
Warning[207]: Found label after column 1. (TECLA_3)
0146                  00066         TECLA_3:                                        ;Ton - 100%
0146   1986           00067                 btfsc   TECLA,3
0147   0008           00068                 return
                      00069                 
0148   30FA           00070                 movlw   B'11111010'             
0149   0095           00071                 movwf   CCPR1L
014A   1697           00072                 bsf             CCP1CON,5
014B   1217           00073                 bcf             CCP1CON,4
                      00074         
014C   0008           00075         return
                      00381 #INCLUDE <MemoriasDec.inc>
                      00001 ;* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
                      00002 ;*                   Biblioteca MemoriasDec                        *
                      00003 ;*                          UTFPR                                      *
                      00004 ;*         DESENVOLVIDO POR     ADRIANO REICHERT                               *
                      00005 ;*   VERSO: 1.0                           DATA: 30/10/2015        *
                      00006 ;*                                                                                                      
                                       *
                      00007 ;* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
                      00008 ;*                     DESCRIO DO ARQUIVO                        *
                      00009 ;*                                                                                                      
                                       *
                      00010 ;*                       Memrias FLASH e E2PROM                                           *
                      00011 ;*-----------------------------------------------------------------*
                      00012 ;* A Biblioteca MemoriasDec Apresenta no LCD os valores em         *
                      00013 ;* Base Decimal                                                                                        *
                      00014 ;* A Biblioteca MemoriasHex Apresenta no LCD os valores em         *
                      00015 ;* Base Hexadecimal                                                                                     
                               *
                      00016 ;* Apenas uma destas Bibliotecas deve ser incluida ao projeto,     *
                      00017 ;* As duas ao mesmo tempo entram em conflito                                       *
                      00018 ;*-----------------------------------------------------------------*
                      00019 ;* Requer Include da Biblioteca Teclado                                                    *
                      00020 ;* Requer Include da Biblioteca LCD                                                            *
                      00021 ;* Requer Include da Biblioteca Decimal                                                *        
                      00022 ;*-----------------------------------------------------------------*
                      00023 ;* Funo ESCR_E2PROM                                                                                   
                               *            
                      00024 ;* Funo LEIT_E2PROM                                                                                   
                               *
                      00025 ;* Funo ESCR_FLASH                                                                                    
                               *
                      00026 ;* Funo LEIT_FLASH                                                                                    
                               *
                      00027 ;* Funo INICIALIZA_DISPLAY_E2PROM                                                                *
                      00028 ;* Funo MENU_E2PROM                                                                                   
                               *
                      00029 ;* Funo ATUALIZA_DISPLAY_ENDERECO                                                                *
                      00030 ;* Funo ATUALIZA_DISPLAY_DADO                                                                    *
                      00031 ;* Funo LIMPA_DISPLAY_DADO                                                                       *
MPASM  5.51                           APS.ASM   7-1-2016  15:53:01         PAGE 21


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00032 ;* Funo INICIALIZA_E2PROM                                                                        *    
                                                               
                      00033 ;*-----------------------------------------------------------------*
                      00034 ;* Variveis para serem declaradas no cdigo principal:            *
                      00035 ;* ENDERECO             ;Biblioteca MemoriasDec                                                    *
                      00036 ;* ENDERECO_H   ;Biblioteca MemoriasDec                                                *
                      00037 ;* ENDERECO_L   ;Biblioteca MemoriasDec                                                    *
                      00038 ;* DADO                 ;Biblioteca MemoriasDec                                                    *
                      00039 ;* DADO_H               ;Biblioteca MemoriasDec                                                    *
                      00040 ;* DADO_L               ;Biblioteca MemoriasDec                                                    *
                      00041 ;* AUXTECLA             ;Biblioteca MemoriasDec                                                    *    
                                                                                                                       
                      00042 ;* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
014D                  00043 MEMORIA:
                      00044 
014D   0826           00045         MOVF    ENDERECO, W
014E   3A14           00046         XORLW   D'20'
014F   1D03           00047         BTFSS   STATUS, Z
0150   2953           00048                 GOTO    AQUI
0151   3000           00049         movlw   0X00
0152   00A6           00050         movwf   ENDERECO
                      00051 
0153                  00052 AQUI:
0153   0836           00053         movf    TEMPERATURA_c,W
0154   00A9           00054         movwf   DADO
0155   216A           00055         call    ESCREVE_E2PROM
                      00056         
0156   3005           00057         movlw   .5
0157   20E9           00058         call    DELAY
                      00059         
0158   0838           00060         movf    TEMPERATURA_d,W
0159   00A9           00061         movwf   DADO
Message[305]: Using default destination of 1 (file).
015A   0AA6           00062         incf    ENDERECO
015B   216A           00063         call    ESCREVE_E2PROM
                      00064         
015C   3005           00065         movlw   .5
015D   20E9           00066         call    DELAY
                      00067         
015E   0839           00068         movf    TEMPERATURA_u,W
015F   00A9           00069         movwf   DADO
Message[305]: Using default destination of 1 (file).
0160   0AA6           00070         incf    ENDERECO
0161   216A           00071         call    ESCREVE_E2PROM
                      00072         
0162   3005           00073         movlw   .5
0163   20E9           00074         call    DELAY
                      00075         
0164   083B           00076         movf    TEMPERATURA_x,W
0165   00A9           00077         movwf   DADO
Message[305]: Using default destination of 1 (file).
0166   0AA6           00078         incf    ENDERECO
0167   216A           00079         call    ESCREVE_E2PROM
MPASM  5.51                           APS.ASM   7-1-2016  15:53:01         PAGE 22


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00080         
Message[305]: Using default destination of 1 (file).
0168   0AA6           00081         incf    ENDERECO
0169   0008           00082         return
                      00083 
                      00084 
                      00085 ;* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
                      00086 ;*                           FUNO ESCR_E2PROM                            *
                      00087 ;*                                                                         *
                      00088 ;* Est funo Recebe como Argumento um DADO e um ENDERECO, e faz  * 
                      00089 ;* a escrita na E2PROM do DADO na posio passada pelo ENDERECO    *
                      00090 ;* --------------------------------------------------------------- *
                      00091 ;* Variveis de Entrada:         |   Variveis de Sada:           *
                      00092 ;*     (Argumentos)              |       (Retornos)                        *
                      00093 ;* DADO                              |                                             *
                      00094 ;* ENDERECO                              |                                                 *
                      00095 ;* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
016A                  00096 ESCREVE_E2PROM 
                      00097 
016A   0829           00098         movf    DADO,W 
                      00099         BANK2                           ;BANKSEL EEDATA 
016B   1703               M                                 bsf STATUS,RP1
016C   1283               M                                 bcf     STATUS,RP0
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
016D   008C           00100         movwf   EEDATA 
                      00101         BANK0 
016E   1303               M                                 bcf STATUS,RP1
016F   1283               M                                 bcf     STATUS,RP0
0170   0826           00102         movf    ENDERECO,W 
                      00103         BANK2                           ;BANKSEL EEADR 
0171   1703               M                                 bsf STATUS,RP1
0172   1283               M                                 bcf     STATUS,RP0
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0173   008D           00104         movwf   EEADR 
                      00105         BANK3                           ;BANKSEL EECON1 
0174   1703               M                                 bsf STATUS,RP1
0175   1683               M                                 bsf     STATUS,RP0
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0176   138C           00106         bcf             EECON1,EEPGD 
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0177   150C           00107         bsf             EECON1,WREN 
0178   3055           00108         movlw   0x55 
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0179   008D           00109         movwf   EECON2          ;OBRIGATRIO. 
017A   30AA           00110         movlw   0xAA 
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
017B   008D           00111         movwf   EECON2          ;OBRIGATRIO.
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
017C   148C           00112         bsf             EECON1,WR   ;INICIA ESCRITA. 
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
017D   188C           00113         btfsc   EECON1,WR 
017E   297D           00114         goto$-1 
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
MPASM  5.51                           APS.ASM   7-1-2016  15:53:01         PAGE 23


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

017F   110C           00115         bcf             EECON1,WREN 
                      00116         BANK0 
0180   1303               M                                 bcf STATUS,RP1
0181   1283               M                                 bcf     STATUS,RP0
0182   0008           00117         return
                      00118 
                      00119 
                      00120 ;* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
                      00121 ;*                           FUNO LEIT_E2PROM                            *
                      00122 ;*                                                                         *
                      00123 ;* Est funo Recebe como Argumento um ENDERECO, ento faz a      * 
                      00124 ;* leitura da E2PROM na posio passada pelo ENDERECO,             *
                      00125 ;* O contedo desta posio  passado para DADO                            *
                      00126 ;* --------------------------------------------------------------- *
                      00127 ;* Variveis de Entrada:         |   Variveis de Sada:           *
                      00128 ;*     (Argumentos)              |       (Retornos)                        *
                      00129 ;* ENDERECO                              | DADO                                        *
                      00130 ;* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
0183                  00131 LEIT_E2PROM 
                      00132 ;       bcf             INTCON,GIE      ;DesLiga chave geral de int
                      00133 
0183   0826           00134         movf    ENDERECO,W 
                      00135         BANK2                           ;BANKSEL EEADR 
0184   1703               M                                 bsf STATUS,RP1
0185   1283               M                                 bcf     STATUS,RP0
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0186   008D           00136         movwf   EEADR 
                      00137         BANK3                           ;BANKSEL EECON1 
0187   1703               M                                 bsf STATUS,RP1
0188   1683               M                                 bsf     STATUS,RP0
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0189   138C           00138         bcf     EECON1,EEPGD 
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
018A   140C           00139         bsf     EECON1,RD 
                      00140         BANK2                           ;BANKSEL EEDATA 
018B   1703               M                                 bsf STATUS,RP1
018C   1283               M                                 bcf     STATUS,RP0
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
018D   080C           00141         movf    EEDATA,W 
                      00142         BANK0                           ;BANKSEL DADO 
018E   1303               M                                 bcf STATUS,RP1
018F   1283               M                                 bcf     STATUS,RP0
0190   00A9           00143         movwf   DADO 
                      00144 
                      00145 ;       bsf             INTCON,GIE      ;Liga chave geral de int
0191   0008           00146         return
                      00147 
                      00382 #INCLUDE <math.inc>
                      00001 
                      00002 
                      00003 
0192                  00004 MULTIPLICA_4x4
                      00005 
MPASM  5.51                           APS.ASM   7-1-2016  15:53:01         PAGE 24


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0192   0103           00006         clrw
0193   1003           00007         bcf     STATUS,C
0194   183C           00008         btfsc   MULT_1,0
0195   073D           00009         addwf   MULT_2,W
0196   0DBD           00010         rlf             MULT_2,F
0197   18BC           00011         btfsc   MULT_1,1
0198   073D           00012         addwf   MULT_2,W
0199   0DBD           00013         rlf             MULT_2,F
019A   193C           00014         btfsc   MULT_1,2
019B   073D           00015         addwf   MULT_2,W
019C   0DBD           00016         rlf     MULT_2,F
019D   19BC           00017         btfsc   MULT_1,3
019E   073D           00018         addwf   MULT_2,W
019F   00BE           00019         movwf   PRODUTO
01A0   0DBD           00020         rlf     MULT_2,F
01A1   0EBD           00021         swapf   MULT_2,F
01A2   0008           00022         return
                      00023 
                      00024 ;********************************************************
                      00025 ;********************************************************
                      00026 ;********************************************************
                      00027 
01A3                  00028 MULTIPLICA_8x8
                      00029 
01A3   01BF           00030         clrf    PRODUTO_H
01A4   01C0           00031         clrf    PRODUTO_L
                      00032 
01A5                  00033 TESTE_ZERO
                      00034 
01A5   083C           00035         movf    MULT_1,W
01A6   3A00           00036         xorlw   0x00
01A7   1903           00037         btfsc   STATUS,Z
01A8   0008           00038         return
                      00039 
01A9   083D           00040         movf    MULT_2,W
01AA   3A00           00041         xorlw   0x00
                      00042 
01AB   1903           00043         btfsc   STATUS,Z
01AC   0008           00044         return
                      00045 
01AD                  00046 MULTIPLICA
                      00047 
01AD   083D           00048         movf    MULT_2,W
01AE   07C0           00049         addwf   PRODUTO_L,F
01AF   1803           00050         btfsc   STATUS,C
01B0   0ABF           00051         incf    PRODUTO_H,F
01B1   0BBC           00052         decfsz  MULT_1,F
01B2   29AD           00053         goto    MULTIPLICA
01B3   0008           00054         return
                      00055 ;********************************************************
                      00056 ;********************************************************
                      00057 ;********************************************************
01B4                  00058 MULTIPLICA_10x8
MPASM  5.51                           APS.ASM   7-1-2016  15:53:01         PAGE 25


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00059 
01B4   01BF           00060         clrf    PRODUTO_H
01B5   01C0           00061         clrf    PRODUTO_L
                      00062 
01B6   083D           00063         movf    MULT_2,W
01B7   00C1           00064         movwf   MULT_TMP
                      00065 
01B8                  00066 TESTA_MULT_1
                      00067 
01B8   18C2           00068         btfsc   MULT_1_H,1
01B9   29C0           00069         goto    TESTA_MULT_2
01BA   1842           00070         btfsc   MULT_1_H,0
01BB   29C0           00071         goto    TESTA_MULT_2
                      00072         
01BC   0843           00073         movf    MULT_1_L,W
01BD   3A00           00074         xorlw   0x00
01BE   1903           00075         btfsc   STATUS,Z
01BF   0008           00076         return
                      00077 
01C0                  00078 TESTA_MULT_2
                      00079 
01C0   083D           00080         movf    MULT_2,W
01C1   3A00           00081         xorlw   0x00
01C2   1903           00082         btfsc   STATUS,Z
01C3   0008           00083         return
                      00084 
01C4                  00085 MULTIPLICAX
                      00086 
01C4   0843           00087         movf    MULT_1_L,W
01C5   07C0           00088         addwf   PRODUTO_L,F
01C6   1803           00089         btfsc   STATUS,C
                      00090 
01C7   0ABF           00091         incf    PRODUTO_H,F
01C8   0842           00092         movf    MULT_1_H,W
Message[305]: Using default destination of 1 (file).
01C9   07BF           00093         addwf   PRODUTO_H
01CA   0BC1           00094         decfsz  MULT_TMP,F
01CB   29C4           00095         goto    MULTIPLICAX
01CC   0008           00096         return
                      00097 ;************************************************************
                      00098 ;***********************************************************
                      00099 ;************************************************************
                      00100 
01CD                  00101 DIVIDE_16x16
                      00102 
01CD   01C4           00103         clrf    QUOCIENTE_H
01CE   01C5           00104         clrf    QUOCIENTE_L
01CF   0847           00105         movf    DIVIDENDO_L,W
01D0   00C9           00106         movwf   RESTOTMP_L
01D1   00CB           00107         movwf   RESTO_L
01D2   0846           00108         movf    DIVIDENDO_H,W
01D3   00C8           00109         movwf   RESTOTMP_H
01D4   00CA           00110         movwf   RESTO_H 
MPASM  5.51                           APS.ASM   7-1-2016  15:53:01         PAGE 26


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00111 
01D5                  00112 T_DIVIDENDO
01D5   0846           00113         movf    DIVIDENDO_H,W
01D6   00D3           00114         movwf   DIVIDENDOTMP_H
01D7   0847           00115         movf    DIVIDENDO_L,W
01D8   00D4           00116         movwf   DIVIDENDOTMP_L
01D9   084C           00117         movf    DIVISOR_H,W
01DA   00D5           00118         movwf   DIVISORTMP_H
01DB   084D           00119         movf    DIVISOR_L,W
01DC   00D6           00120         movwf   DIVISORTMP_L
                      00121         
01DD   0856           00122         movf    DIVISORTMP_L,W
01DE   0254           00123         subwf   DIVIDENDOTMP_L,W
01DF   3001           00124         movlw   0x01
01E0   1C03           00125         btfss   STATUS,C
01E1   0253           00126         subwf   DIVIDENDOTMP_H,W
01E2   1C03           00127         btfss   STATUS,C
01E3   29E8           00128         goto    DIV
01E4   0847           00129         movf    DIVIDENDO_L,W
01E5   00CB           00130         movwf   RESTO_L ;*
01E6   0846           00131         movf    DIVIDENDO_H,W
01E7   00CA           00132         movwf   RESTO_H ;*
                      00133 
01E8                  00134 DIV
                      00135 
01E8   21F4           00136         call    SUBTRAI_16x16
01E9   3001           00137         movlw   0x01
01EA   1C03           00138         btfss   STATUS,C
01EB   0008           00139         return
                      00140 
01EC   07C5           00141         addwf   QUOCIENTE_L,F
01ED   1803           00142         btfsc   STATUS,C
01EE   0AC4           00143         incf    QUOCIENTE_H,F
01EF   0849           00144         movf    RESTOTMP_L,W
01F0   00CB           00145         movwf   RESTO_L
01F1   0848           00146         movf    RESTOTMP_H,W
01F2   00CA           00147         movwf   RESTO_H
01F3   29E8           00148         goto    DIV
                      00149 
01F4                  00150 SUBTRAI_16x16
                      00151 
01F4   084D           00152         movf    DIVISOR_L,W
01F5   02C9           00153         subwf   RESTOTMP_L,F
01F6   3001           00154         movlw   0x01
01F7   1C03           00155         btfss   STATUS,C
01F8   02C8           00156         subwf   RESTOTMP_H,F
01F9   1C03           00157         btfss   STATUS,C
01FA   29FE           00158         goto    EMPRESTA
01FB   084C           00159         movf    DIVISOR_H,W
01FC   02C8           00160         subwf   RESTOTMP_H,F
01FD   0008           00161         return
                      00162 
01FE                  00163 EMPRESTA
MPASM  5.51                           APS.ASM   7-1-2016  15:53:01         PAGE 27


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00164 
01FE   084C           00165         movf    DIVISOR_H,W
01FF   02C8           00166         subwf   RESTOTMP_H,F
0200   1003           00167         bcf     STATUS,C
0201   0008           00168         return
                      00383 #INCLUDE <terminal.inc>
                      00001 ;* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
                      00002 ;*                   Biblioteca TERMINAL                           *
                      00003 ;*                          UTFPR                                      *
                      00004 ;*         DESENVOLVIDO POR     MATHEUS MILANI DE ASSUNO                         *
                      00005 ;*                                              E RODRIGO SBARDELOTO KRAEMER               *
                      00006 ;*   VERSO: 1.0                           DATA: 30/06/2016        *
                      00007 ;*                                                                                                      
                                       *
                      00008 ;* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
                      00009 ;*                     DESCRIO DO ARQUIVO                        *
                      00010 ;*-----------------------------------------------------------------*
                      00011 ;* NO REQUER INCLUDE DE OUTRAS BIBLIOTECAS                                    *
                      00012 ;* A BIBLIOTECA TERMINAL FAZ A COMUNICAO DO KIT DIDATICO COM     *
                      00013 ;* O PC VIA USART, APENAS TRANSMITINDO DADOS                       *
                      00014 ;*-----------------------------------------------------------------*
                      00015 ;* Funo TERMINAL                                                                                      
                               *                                               
                      00016 ;*-----------------------------------------------------------------*
                      00017 ;* Variveis para serem declaradas no cdigo principal:            *
                      00018 ;* AUXTRANS                                     ; ROTINA PRINCIPAL                                      
                               *
                      00019 ;* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
                      00020 ;* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
                      00021 ;*                  FUNO TERMINAL                                                    *
                      00022 ;*                                                                         *
                      00023 ;* EST FUNO TEM COMO ARGUMENTO A VARIAVEL TEMPERATURA           *
                      00024 ;* --------------------------------------------------------------- *
                      00025 ;* Variveis de Entrada:         |   Variveis de Sada:           *
                      00026 ;*     (Argumentos)              |       (Retornos)                        *
                      00027 ;* TEMPERATURA_c                 |                                         *
                      00028 ;* TEMPERATURA_d                 |                                         *
                      00029 ;* TEMPERATURA_u                 |                                         *
                      00030 ;* TEMPERATURA_x                 |                                         *
                      00031 ;* FLAG                                  |                                         *
                      00032 ;*-----------------------------------------------------------------*
                      00033 ;* EST ROTINA DEVE SER CHAMADA DEPOIS QUE A VARIAVEL TEMPERATURA  *
                      00034 ;* FOR CONVERTIDA EM CENTENA, DEZENA, UNIDADE E NUMERO FRACIONARIO *            
                      00035 ;* E TEM COMO ESTADO NA MAQUINA DE ESTADOS NUMERO 3                                *
                      00036 ;*-----------------------------------------------------------------*
0202                  00037 SEND:   
0202   138B           00038         BCF             INTCON,GIE              ;; HABILITA INTERRUPCAO GLOBAL
0203   0836           00039         movf    TEMPERATURA_c,W
0204   0099           00040         MOVWF   TXREG           ;MOVE O DADO A SER TRANSMITIDO PARA O BUFFER DO TRANSMISSOR
                      00041         BANK1
0205   1303               M                                 bcf STATUS,RP1
0206   1683               M                                 bsf     STATUS,RP0
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
MPASM  5.51                           APS.ASM   7-1-2016  15:53:01         PAGE 28


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0207   1C98           00042         BTFSS   TXSTA,TRMT      ;J TRANSMITIU O DADO?
0208   2A07           00043         GOTO    $-1
                      00044         BANK0
0209   1303               M                                 bcf STATUS,RP1
020A   1283               M                                 bcf     STATUS,RP0
020B   178B           00045         BSF             INTCON,GIE              ;; HABILITA INTERRUPCAO GLOBAL
                      00046 
020C   301E           00047         movlw   .30
020D   20E9           00048         call    DELAY
                      00049         
020E   138B           00050         BCF             INTCON,GIE              ;; HABILITA INTERRUPCAO GLOBAL
020F   0838           00051         movf    TEMPERATURA_d,W
0210   0099           00052         MOVWF   TXREG           ;MOVE O DADO A SER TRANSMITIDO PARA O BUFFER DO TRANSMISSOR
                      00053         BANK1
0211   1303               M                                 bcf STATUS,RP1
0212   1683               M                                 bsf     STATUS,RP0
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0213   1C98           00054         BTFSS   TXSTA,TRMT      ;J TRANSMITIU O DADO?
0214   2A13           00055         GOTO    $-1
                      00056         BANK0
0215   1303               M                                 bcf STATUS,RP1
0216   1283               M                                 bcf     STATUS,RP0
0217   178B           00057         BSF             INTCON,GIE              ;; HABILITA INTERRUPCAO GLOBAL
                      00058         
0218   301E           00059         movlw   .30
0219   20E9           00060         call    DELAY
                      00061         
021A   138B           00062         BCF             INTCON,GIE              ;; HABILITA INTERRUPCAO GLOBAL
021B   0839           00063         movf    TEMPERATURA_u,W
021C   0099           00064         MOVWF   TXREG           ;MOVE O DADO A SER TRANSMITIDO PARA O BUFFER DO TRANSMISSOR
                      00065         BANK1
021D   1303               M                                 bcf STATUS,RP1
021E   1683               M                                 bsf     STATUS,RP0
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
021F   1C98           00066         BTFSS   TXSTA,TRMT      ;J TRANSMITIU O DADO?
0220   2A1F           00067         GOTO    $-1
                      00068         BANK0
0221   1303               M                                 bcf STATUS,RP1
0222   1283               M                                 bcf     STATUS,RP0
0223   178B           00069         BSF             INTCON,GIE              ;; HABILITA INTERRUPCAO GLOBAL
                      00070         
0224   301E           00071         movlw   .30
0225   20E9           00072         call    DELAY
                      00073         
0226   138B           00074         BCF             INTCON,GIE              ;; HABILITA INTERRUPCAO GLOBAL
0227   302E           00075         movlw   '.'
0228   0099           00076         MOVWF   TXREG           ;MOVE O DADO A SER TRANSMITIDO PARA O BUFFER DO TRANSMISSOR
                      00077         BANK1
0229   1303               M                                 bcf STATUS,RP1
022A   1683               M                                 bsf     STATUS,RP0
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
022B   1C98           00078         BTFSS   TXSTA,TRMT      ;J TRANSMITIU O DADO?
022C   2A2B           00079         GOTO    $-1
MPASM  5.51                           APS.ASM   7-1-2016  15:53:01         PAGE 29


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00080         BANK0
022D   1303               M                                 bcf STATUS,RP1
022E   1283               M                                 bcf     STATUS,RP0
022F   178B           00081         BSF             INTCON,GIE              ;; HABILITA INTERRUPCAO GLOBAL
                      00082         
0230   301E           00083         movlw   .30
0231   20E9           00084         call    DELAY
                      00085         
0232   138B           00086         BCF             INTCON,GIE              ;; HABILITA INTERRUPCAO GLOBAL
0233   083B           00087         movf    TEMPERATURA_x,W
0234   0099           00088         MOVWF   TXREG           ;MOVE O DADO A SER TRANSMITIDO PARA O BUFFER DO TRANSMISSOR
                      00089         BANK1
0235   1303               M                                 bcf STATUS,RP1
0236   1683               M                                 bsf     STATUS,RP0
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0237   1C98           00090         BTFSS   TXSTA,TRMT      ;J TRANSMITIU O DADO?
0238   2A37           00091         GOTO    $-1
                      00092         BANK0
0239   1303               M                                 bcf STATUS,RP1
023A   1283               M                                 bcf     STATUS,RP0
023B   178B           00093         BSF             INTCON,GIE              ;; HABILITA INTERRUPCAO GLOBAL
                      00094         
023C   301E           00095         movlw   .30
023D   20E9           00096         call    DELAY
                      00097         
023E   138B           00098         BCF             INTCON,GIE              ;; HABILITA INTERRUPCAO GLOBAL
023F   3043           00099         movlw   'C'
0240   0099           00100         MOVWF   TXREG           ;MOVE O DADO A SER TRANSMITIDO PARA O BUFFER DO TRANSMISSOR
                      00101         BANK1
0241   1303               M                                 bcf STATUS,RP1
0242   1683               M                                 bsf     STATUS,RP0
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0243   1C98           00102         BTFSS   TXSTA,TRMT      ;J TRANSMITIU O DADO?
0244   2A43           00103         GOTO    $-1
                      00104         BANK0
0245   1303               M                                 bcf STATUS,RP1
0246   1283               M                                 bcf     STATUS,RP0
0247   178B           00105         BSF             INTCON,GIE              ;; HABILITA INTERRUPCAO GLOBAL
                      00106         
0248   301E           00107         movlw   .30
0249   20E9           00108         call    DELAY
                      00109         
024A   138B           00110         BCF             INTCON,GIE              ;; HABILITA INTERRUPCAO GLOBAL
024B   300A           00111         movlw   .10
024C   0099           00112         MOVWF   TXREG           ;MOVE O DADO A SER TRANSMITIDO PARA O BUFFER DO TRANSMISSOR
                      00113         BANK1
024D   1303               M                                 bcf STATUS,RP1
024E   1683               M                                 bsf     STATUS,RP0
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
024F   1C98           00114         BTFSS   TXSTA,TRMT      ;J TRANSMITIU O DADO?
0250   2A4F           00115         GOTO    $-1
                      00116         BANK0
0251   1303               M                                 bcf STATUS,RP1
MPASM  5.51                           APS.ASM   7-1-2016  15:53:01         PAGE 30


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0252   1283               M                                 bcf     STATUS,RP0
0253   178B           00117         BSF             INTCON,GIE              ;; HABILITA INTERRUPCAO GLOBAL
                      00118         
0254   11A4           00119         bcf             FLAG,3
                      00120         
Warning[203]: Found opcode in column 1. (RETURN)
0255   0008           00121 RETURN
                      00384 #INCLUDE <user.inc>
                      00001 ;* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
                      00002 ;*                   Biblioteca USER                               *
                      00003 ;*                          UTFPR                                      *
                      00004 ;*         DESENVOLVIDO POR     MATHEUS MILANI DE ASSUNO                         *
                      00005 ;*                                              E RODRIGO SBARDELOTO KRAEMER               *
                      00006 ;*   VERSO: 1.0                           DATA: 30/06/2016        *
                      00007 ;*                                                                                                      
                                       *
                      00008 ;* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
                      00009 ;*                     DESCRIO DO ARQUIVO                        *
                      00010 ;*-----------------------------------------------------------------*
                      00011 ;* EST BIBLIOTECA NO REQUER INCLUDE                                                  *
                      00012 ;* A BIBLIOTECA USER FAZ A COMUNICAO DO KIT DIDATICO COM                 *
                      00013 ;* O PC VIA USART, RECEBENDO DADOS DO USUARIO VERIFICANDO O BOTO  *
                      00014 ;* PRESSIONADO E TRANSMITINDO DADOS NA MEMORIA CORRESPONDENTE A    * 
                      00015 ;* ESTE VALOR PRESSIONADO                                                                  *
                      00016 ;*-----------------------------------------------------------------*
                      00017 ;* Funo USER                                                                                          
                               *                                               
                      00018 ;*-----------------------------------------------------------------*
                      00019 ;* Variveis para serem declaradas no cdigo principal:            *
                      00020 ;*      ENDERECO1                               ; ROTINA PRINCIPAL                                      
                               *
                      00021 ;* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
                      00022 
                      00023 ;* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
                      00024 ;*                  FUNO USER                                                        *
                      00025 ;*                                                                         *
                      00026 ;* EST FUNO TEM COMO ARGUMENTO A VARIAVEL TEMPERATURA           *
                      00027 ;* --------------------------------------------------------------- *
                      00028 ;* Variveis de Entrada:         |   Variveis de Sada:           *
                      00029 ;*     (Argumentos)              |       (Retornos)                        *
                      00030 ;* ENDERECO1                                     |                                         *
                      00031 ;* BOTAO                                                 |                                              
                               *
                      00032 ;* FLAG                                  |                                         *
                      00033 ;*-----------------------------------------------------------------*
                      00034 ;* EST ROTINA DEVE SER CHAMADA DEPOIS QUE O USUARIO PRESSIONAR    *
                      00035 ;* UMA TECLA DEPOIS FAZENDO-SE BUSCAR NA MEMORIA E2PROM O VALOR    *
                      00036 ;* CORRESPONDENTE NA MEMORIA E O ENVIANDO PARA O PC. E ESTE ESTADO *
                      00037 ;* FOI DEFINIDO COMO ESTADO NUMERO 6.                                                      *
                      00038 ;*-----------------------------------------------------------------*
0256                  00039 USUARIO:
0256   138B           00040         BCF             INTCON, GIE                                                     
                      00041         
MPASM  5.51                           APS.ASM   7-1-2016  15:53:01         PAGE 31


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0257   0835           00042         MOVF    ENDERECO2, W    ; VARIAVEL RECEBIDA DO TERMINAL(PC)
0258   3A32           00043         XORLW   D'50'
0259   1D03           00044         BTFSS   STATUS, Z
025A   2A5E           00045                 GOTO PROX1
025B   0834           00046         MOVF    ENDERECO1, W
025C   3E04           00047         ADDLW   D'4'
025D   00B4           00048         MOVWF   ENDERECO1
025E                  00049 PROX1:
025E   3A33           00050         XORLW   D'51'
025F   1D03           00051         BTFSS   STATUS, Z
0260   2A64           00052                 GOTO PROX2
0261   0834           00053         MOVF    ENDERECO1, W
0262   3E08           00054         ADDLW   D'8'
0263   00B4           00055         MOVWF   ENDERECO1
0264                  00056 PROX2:
0264   3A34           00057         XORLW   D'52'
0265   1D03           00058         BTFSS   STATUS, Z
0266   2A6A           00059                 GOTO PROX3
0267   0834           00060         MOVF    ENDERECO1, W
0268   3E0C           00061         ADDLW   D'12'
0269   00B4           00062         MOVWF   ENDERECO1
026A                  00063 PROX3:
026A   3A35           00064         XORLW   D'53'
026B   1D03           00065         BTFSS   STATUS, Z
026C   2A70           00066                 GOTO PROX4
026D   0834           00067         MOVF    ENDERECO1, W
026E   3E10           00068         ADDLW   D'16'
026F   00B4           00069         MOVWF   ENDERECO1
0270                  00070 PROX4:
                      00071 ; PRINTA O VALOR DA CENTENA-------------------------------------------------
                      00072         ; BUSCA NA MEMORIA E2PROM
0270   0834           00073         MOVF    ENDERECO1, W    
                      00074         BANK2                           ;BANKSEL EEADR 
0271   1703               M                                 bsf STATUS,RP1
0272   1283               M                                 bcf     STATUS,RP0
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0273   008D           00075         MOVWF   EEADR 
                      00076         BANK3                           ;BANKSEL EECON1 
0274   1703               M                                 bsf STATUS,RP1
0275   1683               M                                 bsf     STATUS,RP0
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0276   138C           00077         BCF     EECON1, EEPGD 
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0277   140C           00078         BSF     EECON1, RD 
                      00079         BANK2                           ;BANKSEL EEDATA 
0278   1703               M                                 bsf STATUS,RP1
0279   1283               M                                 bcf     STATUS,RP0
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
027A   080C           00080         MOVF    EEDATA, W 
                      00081         BANK0                           ;BANKSEL DADO 
027B   1303               M                                 bcf STATUS,RP1
027C   1283               M                                 bcf     STATUS,RP0
                      00082         
MPASM  5.51                           APS.ASM   7-1-2016  15:53:01         PAGE 32


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00083         ; BUSCA NA MEMORIA E2PROM
027D   0099           00084         MOVWF   TXREG                   ;Carrega dados para transmissao
                      00085         BANK1
027E   1303               M                                 bcf STATUS,RP1
027F   1683               M                                 bsf     STATUS,RP0
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0280   1C98           00086                 BTFSS   TXSTA,TRMT              ;Testa quando a transmissao acabou
0281   2A80           00087                         GOTO    $-1
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0282   1098           00088                 BCF             TXSTA,TRMT
                      00089         BANK0
0283   1303               M                                 bcf STATUS,RP1
0284   1283               M                                 bcf     STATUS,RP0
0285   301E           00090         movlw   .30
0286   20E9           00091         call    DELAY
                      00092 ;---------------------------------------------------------------------------    
                      00093 ; PRINTA O VALOR DEZENA-----------------------------------------------------
                      00094         ; BUSCA NA MEMORIA E2PROM
Message[305]: Using default destination of 1 (file).
0287   0AB4           00095         INCF    ENDERECO1
0288   0834           00096         MOVF    ENDERECO1, W 
                      00097         BANK2                           ;BANKSEL EEADR 
0289   1703               M                                 bsf STATUS,RP1
028A   1283               M                                 bcf     STATUS,RP0
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
028B   008D           00098         MOVWF   EEADR 
                      00099         BANK3                           ;BANKSEL EECON1 
028C   1703               M                                 bsf STATUS,RP1
028D   1683               M                                 bsf     STATUS,RP0
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
028E   138C           00100         BCF     EECON1, EEPGD 
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
028F   140C           00101         BSF     EECON1, RD 
                      00102         BANK2                           ;BANKSEL EEDATA 
0290   1703               M                                 bsf STATUS,RP1
0291   1283               M                                 bcf     STATUS,RP0
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0292   080C           00103         MOVF    EEDATA, W 
                      00104         BANK0                           ;BANKSEL DADO 
0293   1303               M                                 bcf STATUS,RP1
0294   1283               M                                 bcf     STATUS,RP0
                      00105         
0295   0099           00106         MOVWF   TXREG                   ;Carrega dados para transmissao
                      00107         BANK1
0296   1303               M                                 bcf STATUS,RP1
0297   1683               M                                 bsf     STATUS,RP0
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0298   1C98           00108                 BTFSS   TXSTA,TRMT              ;Testa quando a transmissao acabou
0299   2A98           00109                         GOTO    $-1
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
029A   1098           00110                 BCF             TXSTA,TRMT
                      00111         BANK0
029B   1303               M                                 bcf STATUS,RP1
MPASM  5.51                           APS.ASM   7-1-2016  15:53:01         PAGE 33


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

029C   1283               M                                 bcf     STATUS,RP0
029D   301E           00112         movlw   .30
029E   20E9           00113         call    DELAY
                      00114 ;---------------------------------------------------------------------------    
                      00115 ; PRINTA O VALOR UNIDADE----------------------------------------------------
                      00116         ; BUSCA NA MEMORIA E2PROM
Message[305]: Using default destination of 1 (file).
029F   0AB4           00117         INCF    ENDERECO1
02A0   0834           00118         MOVF    ENDERECO1, W 
                      00119 
                      00120         BANK2                           ;BANKSEL EEADR 
02A1   1703               M                                 bsf STATUS,RP1
02A2   1283               M                                 bcf     STATUS,RP0
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
02A3   008D           00121         MOVWF   EEADR 
                      00122         BANK3                           ;BANKSEL EECON1 
02A4   1703               M                                 bsf STATUS,RP1
02A5   1683               M                                 bsf     STATUS,RP0
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
02A6   138C           00123         BCF     EECON1, EEPGD 
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
02A7   140C           00124         BSF     EECON1, RD 
                      00125         BANK2                           ;BANKSEL EEDATA 
02A8   1703               M                                 bsf STATUS,RP1
02A9   1283               M                                 bcf     STATUS,RP0
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
02AA   080C           00126         MOVF    EEDATA, W 
                      00127         BANK0                           ;BANKSEL DADO 
02AB   1303               M                                 bcf STATUS,RP1
02AC   1283               M                                 bcf     STATUS,RP0
                      00128 
02AD   0099           00129         MOVWF   TXREG                   ;Carrega dados para transmissao
                      00130         BANK1
02AE   1303               M                                 bcf STATUS,RP1
02AF   1683               M                                 bsf     STATUS,RP0
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
02B0   1C98           00131                 BTFSS   TXSTA,TRMT              ;Testa quando a transmissao acabou
02B1   2AB0           00132                         GOTO    $-1
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
02B2   1098           00133                 BCF             TXSTA,TRMT
                      00134         BANK0
02B3   1303               M                                 bcf STATUS,RP1
02B4   1283               M                                 bcf     STATUS,RP0
                      00135         
02B5   302C           00136         MOVLW   ','
02B6   0099           00137         MOVWF   TXREG                   ;Carrega dados para transmissao
                      00138         BANK1
02B7   1303               M                                 bcf STATUS,RP1
02B8   1683               M                                 bsf     STATUS,RP0
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
02B9   1C98           00139                 BTFSS   TXSTA,TRMT              ;Testa quando a transmissao acabou
02BA   2AB9           00140                         GOTO    $-1
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
MPASM  5.51                           APS.ASM   7-1-2016  15:53:01         PAGE 34


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

02BB   1098           00141                 BCF             TXSTA,TRMT
                      00142         BANK0
02BC   1303               M                                 bcf STATUS,RP1
02BD   1283               M                                 bcf     STATUS,RP0
02BE   301E           00143         movlw   .30
02BF   20E9           00144         call    DELAY
                      00145 ;---------------------------------------------------------------------------    
                      00146 ; PRINTA O VALOR FRACIONARIO------------------------------------------------
                      00147         ; BUSCA NA MEMORIA E2PROM
Message[305]: Using default destination of 1 (file).
02C0   0AB4           00148         INCF    ENDERECO1
02C1   0834           00149         MOVF    ENDERECO1, W 
                      00150         BANK2                           ;BANKSEL EEADR 
02C2   1703               M                                 bsf STATUS,RP1
02C3   1283               M                                 bcf     STATUS,RP0
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
02C4   008D           00151         MOVWF   EEADR 
                      00152         BANK3                           ;BANKSEL EECON1 
02C5   1703               M                                 bsf STATUS,RP1
02C6   1683               M                                 bsf     STATUS,RP0
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
02C7   138C           00153         BCF     EECON1, EEPGD 
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
02C8   140C           00154         BSF     EECON1, RD 
                      00155         BANK2                           ;BANKSEL EEDATA 
02C9   1703               M                                 bsf STATUS,RP1
02CA   1283               M                                 bcf     STATUS,RP0
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
02CB   080C           00156         MOVF    EEDATA, W 
                      00157         BANK0                           ;BANKSEL DADO 
02CC   1303               M                                 bcf STATUS,RP1
02CD   1283               M                                 bcf     STATUS,RP0
                      00158         
02CE   0099           00159         MOVWF   TXREG                   ;Carrega dados para transmissao
                      00160         BANK1
02CF   1303               M                                 bcf STATUS,RP1
02D0   1683               M                                 bsf     STATUS,RP0
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
02D1   1C98           00161                 BTFSS   TXSTA,TRMT              ;Testa quando a transmissao acabou
02D2   2AD1           00162                         GOTO    $-1
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
02D3   1098           00163                 BCF             TXSTA,TRMT
                      00164         BANK0
02D4   1303               M                                 bcf STATUS,RP1
02D5   1283               M                                 bcf     STATUS,RP0
                      00165         
02D6   301E           00166         movlw   .30
02D7   20E9           00167         call    DELAY
                      00168 ;---------------------------------------------------------------------------    
                      00169 ; VAI PARA NOVA LINHA-------------------------------------------------------    
02D8   300A           00170         MOVLW   D'10'
02D9   0099           00171         MOVWF   TXREG                   ;Carrega dados para transmissao
                      00172         BANK1
MPASM  5.51                           APS.ASM   7-1-2016  15:53:01         PAGE 35


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

02DA   1303               M                                 bcf STATUS,RP1
02DB   1683               M                                 bsf     STATUS,RP0
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
02DC   1C98           00173                 BTFSS   TXSTA,TRMT              ;Testa quando a transmissao acabou
02DD   2ADC           00174                         GOTO    $-1
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
02DE   1098           00175                 BCF             TXSTA,TRMT
                      00176         BANK0
02DF   1303               M                                 bcf STATUS,RP1
02E0   1283               M                                 bcf     STATUS,RP0
02E1   301E           00177         movlw   .30
02E2   20E9           00178         call    DELAY
                      00179 ;---------------------------------------------------------------------------
02E3   01B4           00180         CLRF    ENDERECO1
02E4   1324           00181         BCF             FLAG, 6
02E5   178B           00182         BSF             INTCON, GIE
Warning[203]: Found opcode in column 1. (RETURN)
02E6   0008           00183 RETURN
                      00385 
                      00386         END                             ; Fim do programa.
MPASM  5.51                           APS.ASM   7-1-2016  15:53:01         PAGE 36


SYMBOL TABLE
  LABEL                             VALUE 

ACKDT                             00000005
ACKEN                             00000004
ACKSTAT                           00000006
ADCON0                            0000001F
ADCON1                            0000009F
ADCS0                             00000006
ADCS1                             00000007
ADDEN                             00000003
ADFM                              00000007
ADIE                              00000006
ADIF                              00000006
ADON                              00000000
ADRESH                            0000001E
ADRESL                            0000009E
AQUI                              00000153
AUX                               0000002D
AUXTECLA                          0000002C
AUXTRANS                          00000032
BANK0                             
BANK1                             
BANK2                             
BANK3                             
BCLIE                             00000003
BCLIF                             00000003
BF                                00000000
BOTAO                             00000025
BRGH                              00000002
C                                 00000000
CCP1CON                           00000017
CCP1IE                            00000002
CCP1IF                            00000002
CCP1M0                            00000000
CCP1M1                            00000001
CCP1M2                            00000002
CCP1M3                            00000003
CCP1X                             00000005
CCP1Y                             00000004
CCP2CON                           0000001D
CCP2IE                            00000000
CCP2IF                            00000000
CCP2M0                            00000000
CCP2M1                            00000001
CCP2M2                            00000002
CCP2M3                            00000003
CCP2X                             00000005
CCP2Y                             00000004
CCPR1                             00000015
CCPR1H                            00000016
CCPR1L                            00000015
CCPR2                             0000001B
CCPR2H                            0000001C
CCPR2L                            0000001B
CHS0                              00000003
MPASM  5.51                           APS.ASM   7-1-2016  15:53:01         PAGE 37


SYMBOL TABLE
  LABEL                             VALUE 

CHS1                              00000004
CHS2                              00000005
CKE                               00000006
CKP                               00000004
COPIA_RESOLUCAO                   00000082
COPIA_RES_CONVERSAO               00000078
CREN                              00000004
CSRC                              00000007
D                                 00000005
DADO                              00000029
DADO_H                            0000002A
DADO_L                            0000002B
DATA_ADDRESS                      00000005
DC                                00000001
DECODE_DIGITO                     00000085
DELAY                             000000E9
DIV                               000001E8
DIVIDENDOTMP_H                    00000053
DIVIDENDOTMP_L                    00000054
DIVIDENDO_H                       00000046
DIVIDENDO_L                       00000047
DIVIDE_16x16                      000001CD
DIVISORTMP_H                      00000055
DIVISORTMP_L                      00000056
DIVISOR_H                         0000004C
DIVISOR_L                         0000004D
D_A                               00000005
D_NOT_A                           00000005
EEADR                             0000010D
EEADRH                            0000010F
EECON1                            0000018C
EECON2                            0000018D
EEDATA                            0000010C
EEDATH                            0000010E
EEIE                              00000004
EEIF                              00000004
EEPGD                             00000007
EMPRESTA                          000001FE
ENABLE                            PORTE,1
ENDERECO                          00000026
ENDERECO1                         00000034
ENDERECO2                         00000035
ENDERECO_H                        00000027
ENDERECO_L                        00000028
ESCREVE                           000000F2
ESCREVE_E2PROM                    0000016A
ESCR_E2PROM                       0000011A
ESPERA                            000000EC
ESPERA_CONVERSAO                  00000076
ESTADO1                           00000066
ESTADO2                           00000067
ESTADO3                           00000068
ESTADO4                           0000006A
MPASM  5.51                           APS.ASM   7-1-2016  15:53:01         PAGE 38


SYMBOL TABLE
  LABEL                             VALUE 

ESTADO5                           0000006B
ESTADO6                           00000072
F                                 00000001
FERR                              00000002
FLAG                              00000024
FSR                               00000004
GCEN                              00000007
GIE                               00000007
GO                                00000002
GO_DONE                           00000002
GO_NOT_DONE                       00000002
I2C_DATA                          00000005
I2C_READ                          00000002
I2C_START                         00000003
I2C_STOP                          00000004
IBF                               00000007
IBOV                              00000005
IMPRIME                           000000FB
INDF                              00000000
INICIALIZA_E2PROM                 0000010E
INTCON                            0000000B
INTE                              00000004
INTEDG                            00000006
INTF                              00000001
INT_OUT                           0000001A
IRP                               00000007
Inicio                            0000001F
Interrupcao                       00000004
LEIT_E2PROM                       00000183
LIMPA_POSICAO                     00000118
LIMPA_RAM                         00000060
LINHA                             PORTC
LOOP_MEMORIA                      00000115
MEMORIA                           0000014D
MULTIPLICA                        000001AD
MULTIPLICAX                       000001C4
MULTIPLICA_10x8                   000001B4
MULTIPLICA_4x4                    00000192
MULTIPLICA_8x8                    000001A3
MULT_1                            0000003C
MULT_1_H                          00000042
MULT_1_L                          00000043
MULT_2                            0000003D
MULT_TMP                          00000041
Main                              00000066
NOT_A                             00000005
NOT_ADDRESS                       00000005
NOT_BO                            00000000
NOT_BOR                           00000000
NOT_DONE                          00000002
NOT_PD                            00000003
NOT_POR                           00000001
NOT_RBPU                          00000007
MPASM  5.51                           APS.ASM   7-1-2016  15:53:01         PAGE 39


SYMBOL TABLE
  LABEL                             VALUE 

NOT_RC8                           00000006
NOT_T1SYNC                        00000002
NOT_TO                            00000004
NOT_TX8                           00000006
NOT_W                             00000002
NOT_WRITE                         00000002
NUM1                              0000004E
NUM2                              0000004F
NUM3                              00000050
NUM4                              00000051
NUM5                              00000052
OBF                               00000006
OERR                              00000001
ON_LCD                            000000B8
OPTION_REG                        00000081
P                                 00000004
PCFG0                             00000000
PCFG1                             00000001
PCFG2                             00000002
PCFG3                             00000003
PCL                               00000002
PCLATH                            0000000A
PCON                              0000008E
PEIE                              00000006
PEN                               00000002
PIE1                              0000008C
PIE2                              0000008D
PIR1                              0000000C
PIR2                              0000000D
PORTA                             00000005
PORTB                             00000006
PORTC                             00000007
PORTD                             00000008
PORTE                             00000009
PR2                               00000092
PRODUTO                           0000003E
PRODUTO_H                         0000003F
PRODUTO_L                         00000040
PROX1                             0000025E
PROX2                             00000264
PROX3                             0000026A
PROX4                             00000270
PS0                               00000000
PS1                               00000001
PS2                               00000002
PSA                               00000003
PSPIE                             00000007
PSPIF                             00000007
PSPMODE                           00000004
PULSO_seg                         00000022
PWM                               00000133
QUOCIENTE_H                       00000044
QUOCIENTE_L                       00000045
MPASM  5.51                           APS.ASM   7-1-2016  15:53:01         PAGE 40


SYMBOL TABLE
  LABEL                             VALUE 

R                                 00000002
RA0                               00000000
RA1                               00000001
RA2                               00000002
RA3                               00000003
RA4                               00000004
RA5                               00000005
RB0                               00000000
RB1                               00000001
RB2                               00000002
RB3                               00000003
RB4                               00000004
RB5                               00000005
RB6                               00000006
RB7                               00000007
RBIE                              00000003
RBIF                              00000000
RC0                               00000000
RC1                               00000001
RC2                               00000002
RC3                               00000003
RC4                               00000004
RC5                               00000005
RC6                               00000006
RC7                               00000007
RC8_9                             00000006
RC9                               00000006
RCD8                              00000000
RCEN                              00000003
RCIE                              00000005
RCIF                              00000005
RCREG                             0000001A
RCSTA                             00000018
RD                                00000000
RD0                               00000000
RD1                               00000001
RD2                               00000002
RD3                               00000003
RD4                               00000004
RD5                               00000005
RD6                               00000006
RD7                               00000007
RE0                               00000000
RE1                               00000001
RE2                               00000002
READ_WRITE                        00000002
RECEPCAO                          0000000D
RESTOTMP_H                        00000048
RESTOTMP_L                        00000049
RESTO_H                           0000004A
RESTO_L                           0000004B
RP0                               00000005
RP1                               00000006
MPASM  5.51                           APS.ASM   7-1-2016  15:53:01         PAGE 41


SYMBOL TABLE
  LABEL                             VALUE 

RS                                PORTE,0
RSEN                              00000001
RX9                               00000006
RX9D                              00000000
R_NOT_W                           00000002
R_W                               00000002
S                                 00000003
SEN                               00000000
SEND                              00000202
SENSOR                            00000075
SMP                               00000007
SPBRG                             00000099
SPEN                              00000007
SREN                              00000005
SSPADD                            00000093
SSPBUF                            00000013
SSPCON                            00000014
SSPCON2                           00000091
SSPEN                             00000005
SSPIE                             00000003
SSPIF                             00000003
SSPM0                             00000000
SSPM1                             00000001
SSPM2                             00000002
SSPM3                             00000003
SSPOV                             00000006
SSPSTAT                           00000094
STATUS                            00000003
STATUS_TEMP                       00000020
SUBTRAI_16x16                     000001F4
SYNC                              00000004
T0CS                              00000005
T0IE                              00000005
T0IF                              00000002
T0SE                              00000004
T1CKPS0                           00000004
T1CKPS1                           00000005
T1CON                             00000010
T1INSYNC                          00000002
T1OSCEN                           00000003
T1SYNC                            00000002
T2CKPS0                           00000000
T2CKPS1                           00000001
T2CON                             00000012
TECLA                             PORTB
TECLA_0                           00000134
TECLA_1                           0000013A
TECLA_2                           00000140
TECLA_3                           00000146
TEMPERATURA                       00000037
TEMPERATURA_c                     00000036
TEMPERATURA_d                     00000038
TEMPERATURA_m                     0000003A
MPASM  5.51                           APS.ASM   7-1-2016  15:53:01         PAGE 42


SYMBOL TABLE
  LABEL                             VALUE 

TEMPERATURA_u                     00000039
TEMPERATURA_x                     0000003B
TEMPO                             00000011
TEMPO_gravar                      00000023
TEMPO_ms                          00000030
TEMPO_us                          00000031
TEMPO_xms                         0000002E
TESTA_MULT_1                      000001B8
TESTA_MULT_2                      000001C0
TESTE_ZERO                        000001A5
TMR0                              00000001
TMR0IE                            00000005
TMR0IF                            00000002
TMR1                              0000000E
TMR1CS                            00000001
TMR1H                             0000000F
TMR1IE                            00000000
TMR1IF                            00000000
TMR1L                             0000000E
TMR1ON                            00000000
TMR2                              00000011
TMR2IE                            00000001
TMR2IF                            00000001
TMR2ON                            00000002
TOUTPS0                           00000003
TOUTPS1                           00000004
TOUTPS2                           00000005
TOUTPS3                           00000006
TRISA                             00000085
TRISA0                            00000000
TRISA1                            00000001
TRISA2                            00000002
TRISA3                            00000003
TRISA4                            00000004
TRISA5                            00000005
TRISB                             00000086
TRISB0                            00000000
TRISB1                            00000001
TRISB2                            00000002
TRISB3                            00000003
TRISB4                            00000004
TRISB5                            00000005
TRISB6                            00000006
TRISB7                            00000007
TRISC                             00000087
TRISC0                            00000000
TRISC1                            00000001
TRISC2                            00000002
TRISC3                            00000003
TRISC4                            00000004
TRISC5                            00000005
TRISC6                            00000006
TRISC7                            00000007
MPASM  5.51                           APS.ASM   7-1-2016  15:53:01         PAGE 43


SYMBOL TABLE
  LABEL                             VALUE 

TRISD                             00000088
TRISD0                            00000000
TRISD1                            00000001
TRISD2                            00000002
TRISD3                            00000003
TRISD4                            00000004
TRISD5                            00000005
TRISD6                            00000006
TRISD7                            00000007
TRISE                             00000089
TRISE0                            00000000
TRISE1                            00000001
TRISE2                            00000002
TRMT                              00000001
TX8_9                             00000006
TX9                               00000006
TX9D                              00000000
TXD8                              00000000
TXEN                              00000005
TXIE                              00000004
TXIF                              00000004
TXREG                             00000019
TXSTA                             00000098
T_DIVIDENDO                       000001D5
UA                                00000001
USUARIO                           00000256
W                                 00000000
WCOL                              00000007
WR                                00000001
WREN                              00000002
WRERR                             00000003
W_TEMP                            00000021
Z                                 00000002
_BODEN_OFF                        00003FBF
_BODEN_ON                         00003FFF
_BOREN_OFF                        00003FBF
_BOREN_ON                         00003FFF
_CONFIG                           00002007
_CPD_OFF                          00003FFF
_CPD_ON                           00003EFF
_CP_ALL                           00000FCF
_CP_HALF                          00001FDF
_CP_OFF                           00003FFF
_CP_UPPER_256                     00002FEF
_DEBUG_OFF                        00003FFF
_DEBUG_ON                         000037FF
_DEVID1                           00002006
_FOSC_EXTRC                       00003FFF
_FOSC_HS                          00003FFE
_FOSC_LP                          00003FFC
_FOSC_XT                          00003FFD
_HS_OSC                           00003FFE
_IDLOC0                           00002000
MPASM  5.51                           APS.ASM   7-1-2016  15:53:01         PAGE 44


SYMBOL TABLE
  LABEL                             VALUE 

_IDLOC1                           00002001
_IDLOC2                           00002002
_IDLOC3                           00002003
_LP_OSC                           00003FFC
_LVP_OFF                          00003F7F
_LVP_ON                           00003FFF
_PWRTE_OFF                        00003FFF
_PWRTE_ON                         00003FF7
_RC_OSC                           00003FFF
_WDTE_OFF                         00003FFB
_WDTE_ON                          00003FFF
_WDT_OFF                          00003FFB
_WDT_ON                           00003FFF
_WRT_ENABLE_OFF                   00003DFF
_WRT_ENABLE_ON                    00003FFF
_WRT_OFF                          00003DFF
_WRT_ON                           00003FFF
_XT_OSC                           00003FFD
__16F877                          00000001
__DEBUG                           1
__MPLAB_DEBUGGER_ICD2             1
xxx_PRINT                         0000002F
xxx_SEND                          00000033


MEMORY USAGE MAP ('X' = Used,  '-' = Unused)

0000 : X---XXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0040 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0080 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
00C0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0100 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0140 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0180 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
01C0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0200 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0240 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0280 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
02C0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXX--------- ----------------
2000 : -------X-------- ---------------- ---------------- ----------------

All other memory blocks unused.

Program Memory Words Used:   740
Program Memory Words Free:  7452


Errors   :     0
Warnings :    12 reported,     0 suppressed
Messages :    82 reported,     0 suppressed

